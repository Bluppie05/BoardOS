import{ObjectWrapper as t,Color as e,ColorUtils as o,UIString as s,Throttler as i,Settings as n}from"../common/common.js";import{userMetrics as a,InspectorFrontendHost as r,InspectorFrontendHostAPI as l}from"../host/host.js";import{UIUtils as h,Icon as c,Toolbar as d,ARIAUtils as _,Widget as u,ContextMenu as p}from"../ui/ui.js";import{NumberUtilities as g,StringUtilities as C}from"../platform/platform.js";import{SDKModel as m,CSSModel as E}from"../sdk/sdk.js";class b extends t.ObjectWrapper{constructor(t){if(super(),this._isNull=!0,this._contrastRatio=null,this._contrastRatioThresholds=null,this._fgColor=null,this._bgColor=null,!t)return;if(!t.computedFontSize||!t.computedFontWeight||!t.backgroundColors||1!==t.backgroundColors.length)return;this._isNull=!1;const o=b.computeIsLargeFont(t.computedFontSize,t.computedFontWeight);this._contrastRatioThresholds=v[o?"largeFont":"normalFont"];const s=t.backgroundColors[0],i=e.Color.parse(s);i&&this._setBgColorInternal(i)}isNull(){return this._isNull}setColor(t){this._fgColor=t,this._updateContrastRatio(),this.dispatchEventToListeners(f.ContrastInfoUpdated)}color(){return this._fgColor}contrastRatio(){return this._contrastRatio}setBgColor(t){this._setBgColorInternal(t),this.dispatchEventToListeners(f.ContrastInfoUpdated)}_setBgColorInternal(t){if(this._bgColor=t,!this._fgColor)return;const s=this._fgColor.rgba();if(t.hasAlpha()){const i=o.blendColors(t.rgba(),s);this._bgColor=new e.Color(i,e.Format.RGBA)}this._contrastRatio=o.contrastRatio(s,this._bgColor.rgba())}bgColor(){return this._bgColor}_updateContrastRatio(){this._bgColor&&this._fgColor&&(this._contrastRatio=o.contrastRatio(this._fgColor.rgba(),this._bgColor.rgba()))}contrastRatioThreshold(t){return this._contrastRatioThresholds?this._contrastRatioThresholds[t]:null}static computeIsLargeFont(t,e){const o=72*parseFloat(t.replace("px",""))/96;return-1!==["bold","bolder","600","700","800","900"].indexOf(e)?o>=14:o>=18}}const f={ContrastInfoUpdated:Symbol("ContrastInfoUpdated")},v={largeFont:{aa:3,aaa:4.5},normalFont:{aa:4.5,aaa:7}};var F=Object.freeze({__proto__:null,ContrastInfo:b,Events:f,ContrastInfoType:void 0});class A extends t.ObjectWrapper{constructor(t,e,o,i,n){super(),this._contrastInfo=t,this._element=e.createChild("div","spectrum-contrast-details collapsed"),this._toggleMainColorPicker=o,this._expandedChangedCallback=i,this._colorSelectedCallback=n,this._expanded=!1,this._passesAA=!0,this._contrastUnknown=!1,this._visible=!1,this._noContrastInfoAvailable=e.createChild("div","no-contrast-info-available"),this._noContrastInfoAvailable.textContent=ls`No contrast information available`,this._noContrastInfoAvailable.classList.add("hidden");const a=this._element.createChild("div");a.addEventListener("click",this._topRowClicked.bind(this));const r=a.createChild("div","container");h.createTextChild(r,s.UIString("Contrast ratio")),this._contrastValueBubble=r.createChild("span","contrast-details-value"),this._contrastValue=this._contrastValueBubble.createChild("span"),this._contrastValueBubbleIcons=[],this._contrastValueBubbleIcons.push(this._contrastValueBubble.appendChild(c.Icon.create("smallicon-checkmark-square"))),this._contrastValueBubbleIcons.push(this._contrastValueBubble.appendChild(c.Icon.create("smallicon-checkmark-behind"))),this._contrastValueBubbleIcons.push(this._contrastValueBubble.appendChild(c.Icon.create("smallicon-no"))),this._contrastValueBubbleIcons.forEach(t=>t.addEventListener("click",t=>{A._showHelp(),t.consume(!1)}));const l=new d.Toolbar("expand",r);this._expandButton=new d.ToolbarButton(s.UIString("Show more"),"smallicon-expand-more"),this._expandButton.addEventListener(d.ToolbarButton.Events.Click,this._expandButtonClicked.bind(this)),_.setExpanded(this._expandButton.element,!1),l.appendToolbarItem(this._expandButton),this._expandedDetails=this._element.createChild("div","expanded-details"),_.setControls(this._expandButton.element,this._expandedDetails),this._contrastThresholds=this._expandedDetails.createChild("div","contrast-thresholds"),this._contrastAA=this._contrastThresholds.createChild("div","contrast-threshold"),this._contrastPassFailAA=this._contrastAA.createChild("div","contrast-pass-fail"),this._contrastAAA=this._contrastThresholds.createChild("div","contrast-threshold"),this._contrastPassFailAAA=this._contrastAAA.createChild("div","contrast-pass-fail"),this._chooseBgColor=this._expandedDetails.createChild("div","contrast-choose-bg-color"),this._chooseBgColor.textContent=s.UIString("Pick background color");const u=this._expandedDetails.createChild("div","background-color"),p=new d.Toolbar("spectrum-eye-dropper",u);this._bgColorPickerButton=new d.ToolbarToggle(s.UIString("Toggle background color picker"),"largeicon-eyedropper"),this._bgColorPickerButton.addEventListener(d.ToolbarButton.Events.Click,this._toggleBackgroundColorPicker.bind(this,void 0,!0)),p.appendToolbarItem(this._bgColorPickerButton),this._bgColorPickedBound=this._bgColorPicked.bind(this),this._bgColorSwatch=new B(u),this._contrastInfo.addEventListener(f.ContrastInfoUpdated,this._update.bind(this))}_showNoContrastInfoAvailableMessage(){this._noContrastInfoAvailable.classList.remove("hidden")}_hideNoContrastInfoAvailableMessage(){this._noContrastInfoAvailable.classList.add("hidden")}_computeSuggestedColor(t){const o=this._contrastInfo.color(),s=this._contrastInfo.bgColor();if(!o||!s)return;const i=this._contrastInfo.contrastRatioThreshold(t);return i?e.Color.findFgColorForContrast(o,s,i+.05):void 0}_onSuggestColor(t){a.colorFixed(t);const e=this._computeSuggestedColor(t);e&&this._colorSelectedCallback(e)}_createFixColorButton(t,e){const o=this._contrastInfo.color(),s=t.createChild("button","contrast-fix-button"),i=""+e.asString(o?o.format():void 0),n=ls`Use suggested color ${i} to fix low contrast`;return _.setAccessibleName(s,n),s.title=n,s.tabIndex=0,s.style.backgroundColor=i,s}_update(){if(this._contrastInfo.isNull())return this._showNoContrastInfoAvailableMessage(),void this.setVisible(!1);this.setVisible(!0),this._hideNoContrastInfoAvailableMessage();const t=this._contrastInfo.contrastRatio(),e=this._contrastInfo.color(),o=this._contrastInfo.bgColor();if(!t||!o||!e)return this._contrastUnknown=!0,this._contrastValue.textContent="",this._contrastValueBubble.classList.add("contrast-unknown"),this._chooseBgColor.classList.remove("hidden"),this._contrastThresholds.classList.add("hidden"),void this._showNoContrastInfoAvailableMessage();this._contrastUnknown=!1,this._chooseBgColor.classList.add("hidden"),this._contrastThresholds.classList.remove("hidden"),this._contrastValueBubble.classList.remove("contrast-unknown"),this._contrastValue.textContent=t.toFixed(2),this._bgColorSwatch.setColors(e,o);const i=this._contrastInfo.contrastRatioThreshold("aa")||0;this._passesAA=(this._contrastInfo.contrastRatio()||0)>=i,this._contrastPassFailAA.removeChildren();const n=this._contrastPassFailAA.createChild("span","contrast-link-label");if(n.textContent=s.UIString("AA"),this._contrastPassFailAA.createChild("span").textContent=s.UIString(": %s",i.toFixed(1)),this._passesAA)this._contrastPassFailAA.appendChild(c.Icon.create("smallicon-checkmark-square"));else{this._contrastPassFailAA.appendChild(c.Icon.create("smallicon-no"));const t=this._computeSuggestedColor("aa");if(t){this._createFixColorButton(this._contrastPassFailAA,t).addEventListener("click",()=>this._onSuggestColor("aa"))}}const a=this._contrastInfo.contrastRatioThreshold("aaa")||0,r=(this._contrastInfo.contrastRatio()||0)>=a;this._contrastPassFailAAA.removeChildren();const l=this._contrastPassFailAAA.createChild("span","contrast-link-label");if(l.textContent=s.UIString("AAA"),this._contrastPassFailAAA.createChild("span").textContent=s.UIString(": %s",a.toFixed(1)),r)this._contrastPassFailAAA.appendChild(c.Icon.create("smallicon-checkmark-square"));else{this._contrastPassFailAAA.appendChild(c.Icon.create("smallicon-no"));const t=this._computeSuggestedColor("aaa");if(t){this._createFixColorButton(this._contrastPassFailAAA,t).addEventListener("click",()=>this._onSuggestColor("aaa"))}}[n,l].forEach(t=>t.addEventListener("click",t=>A._showHelp())),this._element.classList.toggle("contrast-fail",!this._passesAA),this._contrastValueBubble.classList.toggle("contrast-aa",this._passesAA),this._contrastValueBubble.classList.toggle("contrast-aaa",r)}static _showHelp(){r.InspectorFrontendHostInstance.openInNewTab(h.addReferrerToURL("https://developers.google.com/web/fundamentals/accessibility/accessible-styles#color_and_contrast"))}setVisible(t){this._visible=t,this._element.classList.toggle("hidden",!t)}visible(){return this._visible}element(){return this._element}_expandButtonClicked(t){const e=this._contrastValueBubble.getComponentSelection();e&&e.empty(),this._toggleExpanded()}_topRowClicked(t){const e=this._contrastValueBubble.getComponentSelection();e&&e.empty(),this._toggleExpanded(),t.consume(!0)}_toggleExpanded(){this._expanded=!this._expanded,_.setExpanded(this._expandButton.element,this._expanded),this._element.classList.toggle("collapsed",!this._expanded),this._expanded?(this._toggleMainColorPicker(!1),this._expandButton.setGlyph("smallicon-expand-less"),this._expandButton.setTitle(s.UIString("Show less")),this._contrastUnknown&&this._toggleBackgroundColorPicker(!0)):(this._toggleBackgroundColorPicker(!1),this._expandButton.setGlyph("smallicon-expand-more"),this._expandButton.setTitle(s.UIString("Show more"))),this._expandedChangedCallback()}collapse(){this._element.classList.remove("expanded"),this._toggleBackgroundColorPicker(!1),this._toggleMainColorPicker(!1)}expanded(){return this._expanded}backgroundColorPickerEnabled(){return this._bgColorPickerButton.toggled()}toggleBackgroundColorPicker(t){this._toggleBackgroundColorPicker(t,!1)}_toggleBackgroundColorPicker(t,e=!0){void 0===t&&(t=!this._bgColorPickerButton.toggled()),this._bgColorPickerButton.setToggled(t),e&&this.dispatchEventToListeners(w.BackgroundColorPickerWillBeToggled,t),r.InspectorFrontendHostInstance.setEyeDropperActive(t),t?r.InspectorFrontendHostInstance.events.addEventListener(l.Events.EyeDropperPickedColor,this._bgColorPickedBound):r.InspectorFrontendHostInstance.events.removeEventListener(l.Events.EyeDropperPickedColor,this._bgColorPickedBound)}_bgColorPicked(t){const o=t.data,s=[o.r,o.g,o.b,(o.a/2.55|0)/100],i=e.Color.fromRGBA(s);this._contrastInfo.setBgColor(i),this._toggleBackgroundColorPicker(!1),r.InspectorFrontendHostInstance.bringToFront()}}const w={BackgroundColorPickerWillBeToggled:Symbol("BackgroundColorPickerWillBeToggled")};class B{constructor(t){this._parentElement=t,this._swatchElement=t.createChild("span","swatch contrast swatch-inner-white"),this._swatchInnerElement=this._swatchElement.createChild("span","swatch-inner"),this._textPreview=this._swatchElement.createChild("div","text-preview"),this._textPreview.textContent="Aa"}setColors(t,o){this._textPreview.style.color=t.asString(e.Format.RGBA),this._swatchInnerElement.style.backgroundColor=o.asString(e.Format.RGBA),this._swatchElement.classList.toggle("swatch-inner-white",o.hsla()[2]>.9)}}var S=Object.freeze({__proto__:null,ContrastDetails:A,Events:w,Swatch:B});class k{constructor(t,e){this._contrastInfo=t,this._visible=!1,this._contrastRatioSVG=h.createSVGChild(e,"svg","spectrum-contrast-container fill"),this._contrastRatioLines=new Map,this._contrastRatioLines.set("aa",h.createSVGChild(this._contrastRatioSVG,"path","spectrum-contrast-line")),this._contrastRatioLines.set("aaa",h.createSVGChild(this._contrastRatioSVG,"path","spectrum-contrast-line")),this._width=0,this._height=0,this._contrastRatioLineBuilder=new x(this._contrastInfo),this._contrastRatioLinesThrottler=new i.Throttler(0),this._drawContrastRatioLinesBound=this._drawContrastRatioLines.bind(this),this._contrastInfo.addEventListener(f.ContrastInfoUpdated,this._update.bind(this))}_update(){this._visible&&!this._contrastInfo.isNull()&&this._contrastInfo.contrastRatio()&&this._contrastRatioLinesThrottler.schedule(this._drawContrastRatioLinesBound)}setDimensions(t,e){this._width=t,this._height=e,this._update()}setVisible(t){this._visible=t,this._contrastRatioSVG.classList.toggle("hidden",!t),this._update()}async _drawContrastRatioLines(){for(const[t,e]of this._contrastRatioLines){const o=this._contrastRatioLineBuilder.drawContrastRatioLine(this._width,this._height,t);o?e.setAttribute("d",o):e.removeAttribute("d")}}}class x{constructor(t){this._contrastInfo=t}drawContrastRatioLine(t,s,i){const n=this._contrastInfo.contrastRatioThreshold(i);if(!t||!s||!n)return null;const a=.02,r=this._contrastInfo.color(),l=this._contrastInfo.bgColor();if(!r||!l)return null;const h=r.rgba(),c=r.hsva(),d=l.rgba(),_=o.luminance(d);let u=o.blendColors(h,d);const p=o.luminance(u)>_,g=e.Color.desiredLuminance(_,n,p);let C=c[2],m=0;const E=[c[0],0,0,c[3]];let b=[];const f=[];let v;for(e.Color.hsva2rgba(E,f),u=o.blendColors(f,d),v=0;v<1.02;v+=a){v=Math.min(1,v),E[1]=v,E[2]=C+m*a;const o=e.Color.approachColorValue(E,d,2,g);if(null===o)break;m=0===v?0:(o-C)/a,C=o,b.push(b.length?"L":"M"),b.push((v*t).toFixed(2)),b.push(((1-o)*s).toFixed(2))}return v<1.02&&(v-=a,E[2]=1,v=e.Color.approachColorValue(E,d,1,g),null!==v&&(b=b.concat(["L",(v*t).toFixed(2),"-0.1"]))),0===b.length?null:b.join(" ")}}var P=Object.freeze({__proto__:null,ContrastOverlay:k,ContrastRatioLineBuilder:x});class I extends u.VBox{constructor(t){function e(t){const e=h.createSVGChild(t,"svg");e.setAttribute("height",16),e.setAttribute("width",16);return h.createSVGChild(e,"path").setAttribute("d","M5,6 L11,6 L8,2 Z M5,10 L11,10 L8,14 Z"),e}super(!0),this.registerRequiredCSS("color_picker/spectrum.css",{enableLegacyPatching:!0}),this._colorElement=this.contentElement.createChild("div","spectrum-color"),this._colorElement.tabIndex=0,this.setDefaultFocusedElement(this._colorElement),this._colorElement.addEventListener("keydown",this._onSliderKeydown.bind(this,E.bind(this)));const o=ls`Press arrow keys with or without modifiers to move swatch position. Arrow key with Shift key moves position largely, with Ctrl key it is less and with Alt key it is even less`;_.setAccessibleName(this._colorElement,o),_.markAsApplication(this._colorElement),this._colorDragElement=this._colorElement.createChild("div","spectrum-sat fill").createChild("div","spectrum-val fill").createChild("div","spectrum-dragger"),this._dragX=0,this._dragY=0;const i=this.contentElement.createChild("div","spectrum-tools"),n=new d.Toolbar("spectrum-eye-dropper",i);this._colorPickerButton=new d.ToolbarToggle(s.UIString("Toggle color picker"),"largeicon-eyedropper"),this._colorPickerButton.setToggled(!0),this._colorPickerButton.addEventListener(d.ToolbarButton.Events.Click,this._toggleColorPicker.bind(this,void 0)),n.appendToolbarItem(this._colorPickerButton),this._swatch=new O(i),this._hueElement=i.createChild("div","spectrum-hue"),this._hueElement.tabIndex=0,this._hueElement.addEventListener("keydown",this._onSliderKeydown.bind(this,C.bind(this))),_.setAccessibleName(this._hueElement,ls`Change hue`),_.markAsSlider(this._hueElement,0,360),this._hueSlider=this._hueElement.createChild("div","spectrum-slider"),this._alphaElement=i.createChild("div","spectrum-alpha"),this._alphaElement.tabIndex=0,this._alphaElement.addEventListener("keydown",this._onSliderKeydown.bind(this,m.bind(this))),_.setAccessibleName(this._alphaElement,ls`Change alpha`),_.markAsSlider(this._alphaElement,0,1),this._alphaElementBackground=this._alphaElement.createChild("div","spectrum-alpha-background"),this._alphaSlider=this._alphaElement.createChild("div","spectrum-slider"),this._displayContainer=i.createChild("div","spectrum-text source-code"),_.markAsPoliteLiveRegion(this._displayContainer,!0),this._textValues=[];for(let t=0;t<4;++t){const t=h.createInput("spectrum-text-value");this._displayContainer.appendChild(t),t.maxLength=4,this._textValues.push(t),t.addEventListener("keydown",this._inputChanged.bind(this),!1),t.addEventListener("input",this._inputChanged.bind(this),!1),t.addEventListener("mousewheel",this._inputChanged.bind(this),!1),t.addEventListener("paste",this._pasted.bind(this),!1)}this._textLabels=this._displayContainer.createChild("div","spectrum-text-label"),this._hexContainer=i.createChild("div","spectrum-text spectrum-text-hex source-code"),_.markAsPoliteLiveRegion(this._hexContainer,!0),this._hexValue=h.createInput("spectrum-text-value"),this._hexContainer.appendChild(this._hexValue),this._hexValue.maxLength=9,this._hexValue.addEventListener("keydown",this._inputChanged.bind(this),!1),this._hexValue.addEventListener("input",this._inputChanged.bind(this),!1),this._hexValue.addEventListener("mousewheel",this._inputChanged.bind(this),!1),this._hexValue.addEventListener("paste",this._pasted.bind(this),!1);const a=this._hexContainer.createChild("div","spectrum-text-label");a.textContent=ls`HEX`,_.setAccessibleName(this._hexValue,a.textContent);const r=i.createChild("div","spectrum-display-switcher spectrum-switcher");e(r),r.tabIndex=0,self.onInvokeElement(r,t=>{this._formatViewSwitch(),t.consume(!0)}),_.setAccessibleName(r,ls`Change color format`),_.markAsButton(r),h.installDragHandle(this._hueElement,u.bind(this,C.bind(this)),C.bind(this),null,"pointer","default"),h.installDragHandle(this._alphaElement,u.bind(this,m.bind(this)),m.bind(this),null,"pointer","default"),h.installDragHandle(this._colorElement,u.bind(this,E.bind(this)),E.bind(this),null,"pointer","default"),t&&(this._contrastInfo=t,this._contrastOverlay=new k(this._contrastInfo,this._colorElement),this._contrastDetails=new A(this._contrastInfo,this.contentElement,this._toggleColorPicker.bind(this),this._contrastPanelExpanded.bind(this),this.colorSelected.bind(this)),this._contrastDetailsBackgroundColorPickedToggledBound=this._contrastDetailsBackgroundColorPickedToggled.bind(this)),this.element.classList.add("flex-none"),this._palettes=new Map,this._palettePanel=this.contentElement.createChild("div","palette-panel"),this._palettePanelShowing=!1,this._paletteSectionContainer=this.contentElement.createChild("div","spectrum-palette-container"),this._paletteContainer=this._paletteSectionContainer.createChild("div","spectrum-palette"),this._paletteContainer.addEventListener("contextmenu",this._showPaletteColorContextMenu.bind(this,-1)),this._shadesContainer=this.contentElement.createChild("div","palette-color-shades hidden"),h.installDragHandle(this._paletteContainer,this._paletteDragStart.bind(this),this._paletteDrag.bind(this),this._paletteDragEnd.bind(this),"default");const l=this._paletteSectionContainer.createChild("div","spectrum-palette-switcher spectrum-switcher");e(l),_.markAsButton(l),_.setAccessibleName(l,ls`Preview palettes`),l.tabIndex=0,self.onInvokeElement(l,t=>{this._togglePalettePanel(!0),t.consume(!0)}),this._deleteIconToolbar=new d.Toolbar("delete-color-toolbar"),this._deleteButton=new d.ToolbarButton("","largeicon-trash-bin"),this._deleteIconToolbar.appendToolbarItem(this._deleteButton);this.contentElement.createChild("div","spectrum-overlay fill").addEventListener("click",this._togglePalettePanel.bind(this,!1)),this._addColorToolbar=new d.Toolbar("add-color-toolbar");const c=new d.ToolbarButton(s.UIString("Add to palette"),"largeicon-add");function u(t,e){return this._colorOffset=this._colorElement.totalOffset(),t(e),!0}function p(t,e){const o=t.getBoundingClientRect();switch(e.key){case"ArrowLeft":case"ArrowDown":return o.left-1;case"ArrowRight":case"ArrowUp":return o.right+1;default:return e.x}}function C(t){const e=this._hsv.slice(),o=1-(p(this._hueSlider,t)-this._hueElement.getBoundingClientRect().left)/this._hueAlphaWidth;e[0]=g.clamp(o,0,1),this._innerSetColor(e,"",void 0,void 0,y.Other);const s=this._color().canonicalHSLA();_.setValueNow(this._hueElement,s[0])}function m(t){const e=this._hsv.slice(),o=(p(this._alphaSlider,t)-this._hueElement.getBoundingClientRect().left)/this._hueAlphaWidth,s=Math.round(100*o)/100;e[3]=g.clamp(s,0,1),this._innerSetColor(e,"",void 0,void 0,y.Other);const i=this._color().canonicalHSLA();_.setValueText(this._alphaElement,i[3])}function E(t){const e=this._hsv.slice(),o=function(t,e){const o=t.getBoundingClientRect(),s=o.x+o.width/2,i=o.y+o.width/2,n=function(t,e){e.altKey?t=1:e.ctrlKey?t=10:e.shiftKey&&(t=20);return t}(o.width/4,e);switch(e.key){case"ArrowLeft":return{x:o.left-n,y:i};case"ArrowRight":return{x:o.right+n,y:i};case"ArrowDown":return{x:s,y:o.bottom+n};case"ArrowUp":return{x:s,y:o.top-n};default:return{x:e.x,y:e.y}}}(this._colorDragElement,t);this._colorOffset=this._colorElement.totalOffset(),e[1]=g.clamp((o.x-this._colorOffset.left)/this.dragWidth,0,1),e[2]=g.clamp(1-(o.y-this._colorOffset.top)/this.dragHeight,0,1),this._innerSetColor(e,"",void 0,void 0,y.Other)}c.addEventListener(d.ToolbarButton.Events.Click,this._onAddColorMousedown.bind(this)),c.element.addEventListener("keydown",this._onAddColorKeydown.bind(this)),this._addColorToolbar.appendToolbarItem(c),this._colorPickedBound=this._colorPicked.bind(this),this._loadPalettes(),new R(t=>{t.colors.length?this.addPalette(t):this._selectedColorPalette.get()===t.title&&this._paletteSelected(M)})}_contrastDetailsBackgroundColorPickedToggled({data:t}){t&&this._toggleColorPicker(!1)}_contrastPanelExpanded(){this._contrastOverlay.setVisible(this._contrastDetails.expanded()),this._resizeForSelectedPalette(!0)}_updatePalettePanel(){this._palettePanel.removeChildren();this._palettePanel.createChild("div","palette-title").textContent=s.UIString("Color Palettes");const t=new d.Toolbar("",this._palettePanel);this._closeButton=new d.ToolbarButton(ls`Return to color picker`,"largeicon-delete"),this._closeButton.addEventListener(d.ToolbarButton.Events.Click,this._togglePalettePanel.bind(this,!1)),this._closeButton.element.addEventListener("keydown",this._onCloseBtnKeydown.bind(this)),t.appendToolbarItem(this._closeButton);for(const t of this._palettes.values())this._palettePanel.appendChild(this._createPreviewPaletteElement(t))}_togglePalettePanel(t){this._palettePanelShowing!==t&&(t&&this._updatePalettePanel(),this._palettePanelShowing=t,this.contentElement.classList.toggle("palette-panel-showing",t),this._focus())}_onCloseBtnKeydown(t){(isEscKey(t)||isEnterOrSpaceKey(t))&&(this._togglePalettePanel(!1),t.consume(!0))}_onSliderKeydown(t,e){switch(e.key){case"ArrowLeft":case"ArrowRight":case"ArrowDown":case"ArrowUp":t(e),e.consume(!0)}}_focus(){this.isShowing()&&(this._palettePanelShowing?this._closeButton.element.focus({preventScroll:!0}):this.contentElement.focus())}_createPaletteColor(t,e,o){const s=document.createElement("div");return s.classList.add("spectrum-palette-color"),s.style.background=C.sprintf("linear-gradient(%s, %s), url(Images/checker.png)",t,t),o&&s.animate([{opacity:0},{opacity:1}],{duration:100,delay:o,fill:"backwards"}),s.title=e||t,s}_showPalette(t,e,o){this._resizeForSelectedPalette(),this._paletteContainer.removeChildren();for(let o=0;o<t.colors.length;o++){const s=e?100*o/t.colors.length:0,i=this._createPaletteColor(t.colors[o],t.colorNames[o],s);if(_.markAsButton(i),_.setAccessibleName(i,ls`Color ${t.colors[o]}`),i.tabIndex=-1,i.addEventListener("mousedown",this._paletteColorSelected.bind(this,t.colors[o],t.colorNames[o],Boolean(t.matchUserFormat))),i.addEventListener("focus",this._paletteColorSelected.bind(this,t.colors[o],t.colorNames[o],Boolean(t.matchUserFormat))),i.addEventListener("keydown",this._onPaletteColorKeydown.bind(this,o)),t.mutable)i.__mutable=!0,i.__color=t.colors[o],i.addEventListener("contextmenu",this._showPaletteColorContextMenu.bind(this,o));else if(t===M){i.classList.add("has-material-shades");let e=i.createChild("div","spectrum-palette-color spectrum-palette-color-shadow");e.style.background=t.colors[o],e=i.createChild("div","spectrum-palette-color spectrum-palette-color-shadow"),e.style.background=t.colors[o],i.title=ls`Long-click or long-press space to show alternate shades of ${t.colors[o]}`,_.setAccessibleName(i,i.title),new h.LongClickController(i,this._showLightnessShades.bind(this,i,t.colors[o]))}this._paletteContainer.appendChild(i)}this._paletteContainer.childNodes.length>0&&(this._paletteContainer.childNodes[0].tabIndex=0),this._paletteContainerMutable=t.mutable,t.mutable?(this._paletteContainer.appendChild(this._addColorToolbar.element),this._paletteContainer.appendChild(this._deleteIconToolbar.element)):(this._addColorToolbar.element.remove(),this._deleteIconToolbar.element.remove()),this._togglePalettePanel(!1),this._focus()}_showLightnessShades(t,e,o){this._shadesCloseHandler&&this._shadesCloseHandler(),this._shadesContainer.classList.remove("hidden"),this._shadesContainer.removeChildren(),this._shadesContainer.animate([{transform:"scaleY(0)",opacity:"0"},{transform:"scaleY(1)",opacity:"1"}],{duration:200,easing:"cubic-bezier(0.4, 0, 0.2, 1)"});let s=this._paletteContainer.offsetTop+t.offsetTop+t.parentElement.offsetTop;this._contrastDetails&&(s+=this._contrastDetails.element().offsetHeight),this._shadesContainer.style.top=s+"px",this._shadesContainer.style.left=t.offsetLeft+"px",t.classList.add("spectrum-shades-shown");const i=V[e];for(let e=i.length-1;e>=0;e--){const o=this._createPaletteColor(i[e],void 0,200*e/i.length+100);_.markAsButton(o),_.setAccessibleName(o,ls`Color ${i[e]}`),o.tabIndex=-1,o.addEventListener("mousedown",this._paletteColorSelected.bind(this,i[e],i[e],!1)),o.addEventListener("focus",this._paletteColorSelected.bind(this,i[e],i[e],!1)),o.addEventListener("keydown",this._onShadeColorKeydown.bind(this,t)),this._shadesContainer.appendChild(o)}this._shadesContainer.childNodes.length>0&&this._shadesContainer.childNodes[this._shadesContainer.childNodes.length-1].focus(),this._shadesCloseHandler=function(t){this._shadesContainer.classList.add("hidden"),t.classList.remove("spectrum-shades-shown"),this._shadesContainer.ownerDocument.removeEventListener("mousedown",this._shadesCloseHandler,!0),delete this._shadesCloseHandler}.bind(this,t),this._shadesContainer.ownerDocument.addEventListener("mousedown",this._shadesCloseHandler,!0)}_slotIndexForEvent(t){const e=t.pageX-this._paletteContainer.totalOffsetLeft(),o=t.pageY-this._paletteContainer.totalOffsetTop(),s=Math.min(e/D|0,T-1),i=o/D|0;return Math.min(i*T+s,this._customPaletteSetting.get().colors.length-1)}_isDraggingToBin(t){return t.pageX>this._deleteIconToolbar.element.totalOffsetLeft()}_paletteDragStart(t){const e=t.deepElementFromPoint();if(!e||!e.__mutable)return!1;const o=this._slotIndexForEvent(t);return this._dragElement=e,this._dragHotSpotX=t.pageX-o%T*D,this._dragHotSpotY=t.pageY-(o/T|0)*D,!0}_paletteDrag(t){if(t.pageX<this._paletteContainer.totalOffsetLeft()||t.pageY<this._paletteContainer.totalOffsetTop())return;const e=this._slotIndexForEvent(t),o=t.pageX-e%T*D,s=t.pageY-(e/T|0)*D,i=this._isDraggingToBin(t);this._deleteIconToolbar.element.classList.add("dragging"),this._deleteIconToolbar.element.classList.toggle("delete-color-toolbar-active",i);const n="translateX("+(o-this._dragHotSpotX)+"px) translateY("+(s-this._dragHotSpotY)+"px)";this._dragElement.style.transform=i?n+" scale(0.8)":n;const a=Array.prototype.slice.call(this._paletteContainer.children),r=a.indexOf(this._dragElement),l=new Map;for(const t of a)l.set(t,t.totalOffset());r!==e&&this._paletteContainer.insertBefore(this._dragElement,a[e>r?e+1:e]);for(const t of a){if(t===this._dragElement)continue;const e=l.get(t),o=t.totalOffset();e.left===o.left&&e.top===o.top||t.animate([{transform:"translateX("+(e.left-o.left)+"px) translateY("+(e.top-o.top)+"px)"},{transform:"none"}],{duration:100,easing:"cubic-bezier(0, 0, 0.2, 1)"})}}_paletteDragEnd(t){this._isDraggingToBin(t)&&this._dragElement.remove(),this._dragElement.style.removeProperty("transform");const e=this._paletteContainer.children,o=[];for(let t=0;t<e.length;++t)e[t].__color&&o.push(e[t].__color);const s=this._customPaletteSetting.get();s.colors=o,this._customPaletteSetting.set(s),this._showPalette(this._customPaletteSetting.get(),!1),this._deleteIconToolbar.element.classList.remove("dragging"),this._deleteIconToolbar.element.classList.remove("delete-color-toolbar-active")}_loadPalettes(){this._palettes.set(M.title,M);this._customPaletteSetting=n.Settings.instance().createSetting("customColorPalette",{title:"Custom",colors:[],colorNames:[],mutable:!0});const t=this._customPaletteSetting.get();t.colorNames=t.colorNames||[],this._palettes.set(t.title,t),this._selectedColorPalette=n.Settings.instance().createSetting("selectedColorPalette",H);const e=this._palettes.get(this._selectedColorPalette.get());e&&this._showPalette(e,!0)}addPalette(t){this._palettes.set(t.title,t),this._selectedColorPalette.get()===t.title&&this._showPalette(t,!0)}_createPreviewPaletteElement(t){const e=document.createElement("div");e.classList.add("palette-preview"),_.markAsButton(e),e.tabIndex=0;let o;for(e.createChild("div","palette-preview-title").textContent=t.title,o=0;o<5&&o<t.colors.length;o++)e.appendChild(this._createPaletteColor(t.colors[o],t.colorNames[o]));for(;o<5;o++)e.createChild("div","spectrum-palette-color empty-color");return self.onInvokeElement(e,e=>{this._paletteSelected(t),e.consume(!0)}),e}_paletteSelected(t){this._selectedColorPalette.set(t.title),this._showPalette(t,!0)}_resizeForSelectedPalette(t){const e=this._palettes.get(this._selectedColorPalette.get());if(!e)return;let o=e.colors.length;e===this._customPaletteSetting.get()&&o++;const s=Math.max(1,Math.ceil(o/T));if(this._numPaletteRowsShown===s&&!t)return;this._numPaletteRowsShown=s;let i=236;this._contrastDetails&&(this._contrastDetails.expanded()?i+=78:i+=36),this.element.style.height=i+12+24*s+"px",this.dispatchEventToListeners(L.SizeChanged)}_paletteColorSelected(t,o,s){const i=e.Color.parse(t);i&&this._innerSetColor(i.hsva(),t,o,s?this._colorFormat:i.format(),y.Other)}_onPaletteColorKeydown(t,e){let o;switch(e.key){case"ArrowLeft":o=t-1;break;case"ArrowRight":o=t+1;break;case"ArrowUp":o=t-T;break;case"ArrowDown":o=t+T}o>-1&&o<this._paletteContainer.childNodes.length&&this._paletteContainer.childNodes[o].focus()}_onShadeColorKeydown(t,e){isEscKey(e)||"Tab"===e.key?(t.focus(),this._shadesCloseHandler(),e.consume(!0)):"ArrowUp"===e.key&&e.target.previousElementSibling?(e.target.previousElementSibling.focus(),e.consume(!0)):"ArrowDown"===e.key&&e.target.nextElementSibling&&(e.target.nextElementSibling.focus(),e.consume(!0))}_onAddColorMousedown(){this._addColorToCustomPalette()}_onAddColorKeydown(t){isEnterOrSpaceKey(t)&&(this._addColorToCustomPalette(),t.consume(!0))}_addColorToCustomPalette(){const t=this._customPaletteSetting.get();t.colors.push(this.colorString()),this._customPaletteSetting.set(t),this._showPalette(this._customPaletteSetting.get(),!1);const e=this._paletteContainer.querySelectorAll(".spectrum-palette-color");e[e.length-1].focus()}_showPaletteColorContextMenu(t,e){if(!this._paletteContainerMutable)return;const o=new p.ContextMenu(e);-1!==t&&(o.defaultSection().appendItem(s.UIString("Remove color"),this._deletePaletteColors.bind(this,t,!1)),o.defaultSection().appendItem(s.UIString("Remove all to the right"),this._deletePaletteColors.bind(this,t,!0))),o.defaultSection().appendItem(s.UIString("Clear palette"),this._deletePaletteColors.bind(this,-1,!0)),o.show()}_deletePaletteColors(t,e){const o=this._customPaletteSetting.get();e?o.colors.splice(t+1,o.colors.length-t-1):o.colors.splice(t,1),this._customPaletteSetting.set(o),this._showPalette(this._customPaletteSetting.get(),!1)}setColor(t,e){this._originalFormat=e,this._innerSetColor(t.hsva(),"",void 0,e,y.Model);const o=this._color().canonicalHSLA();_.setValueNow(this._hueElement,o[0]),_.setValueText(this._alphaElement,o[3])}colorSelected(t){this._innerSetColor(t.hsva(),"",void 0,void 0,y.Other)}_innerSetColor(t,o,s,i,n){if(void 0!==t&&(this._hsv=t),this._colorName=s,void 0!==o&&(this._colorString=o),void 0!==i){const t=e.Format;console.assert(i!==t.Original,"Spectrum's color format cannot be Original"),i===t.RGBA?i=t.RGB:i===t.HSLA?i=t.HSL:i===t.HEXA?i=t.HEX:i===t.ShortHEXA&&(i=t.ShortHEX),this._colorFormat=i}t&&this._contrastInfo&&this._contrastInfo.setColor(e.Color.fromHSVA(t)),this._updateHelperLocations(),this._updateUI(),n!==y.Input&&this._updateInput(),n!==y.Model&&this.dispatchEventToListeners(L.ColorChanged,this.colorString())}_color(){return e.Color.fromHSVA(this._hsv)}colorName(){return this._colorName}colorString(){if(this._colorString)return this._colorString;const t=e.Format,o=this._color();let s=o.asString(this._colorFormat);return s||(s=this._colorFormat===t.Nickname?o.asString(o.hasAlpha()?t.HEXA:t.HEX):this._colorFormat===t.ShortHEX?o.asString(o.detectHEXFormat()):this._colorFormat===t.HEX?o.asString(t.HEXA):this._colorFormat===t.HSL?o.asString(t.HSLA):o.asString(t.RGBA),console.assert(s),s||"")}_updateHelperLocations(){const t=this._hsv[0],e=this._hsv[1],o=this._hsv[2],s=this._hsv[3];this._dragX=e*this.dragWidth,this._dragY=this.dragHeight-o*this.dragHeight;const i=Math.max(-this._colorDragElementHeight,Math.min(this.dragWidth-this._colorDragElementHeight,this._dragX-this._colorDragElementHeight)),n=Math.max(-this._colorDragElementHeight,Math.min(this.dragHeight-this._colorDragElementHeight,this._dragY-this._colorDragElementHeight));this._colorDragElement.positionAt(i,n);const a=(1-t)*this._hueAlphaWidth-this.slideHelperWidth;this._hueSlider.style.left=a+"px";const r=s*this._hueAlphaWidth-this.slideHelperWidth;this._alphaSlider.style.left=r+"px"}_updateInput(){const t=e.Format;if(this._colorFormat===t.HEX||this._colorFormat===t.ShortHEX||this._colorFormat===t.Nickname)this._hexContainer.hidden=!1,this._displayContainer.hidden=!0,this._colorFormat===t.ShortHEX?this._hexValue.value=this._color().asString(this._color().detectHEXFormat()):this._hexValue.value=this._color().asString(this._color().hasAlpha()?t.HEXA:t.HEX);else{this._hexContainer.hidden=!0,this._displayContainer.hidden=!1;const e=this._colorFormat===t.RGB;this._textLabels.textContent=e?"RGBA":"HSLA";const o=e?this._color().canonicalRGBA():this._color().canonicalHSLA();for(let t=0;t<3;++t)_.setAccessibleName(this._textValues[t],ls`${this._textLabels.textContent.charAt(t)} in ${this._textLabels.textContent}`),this._textValues[t].value=o[t],e||1!==t&&2!==t||(this._textValues[t].value+="%");_.setAccessibleName(this._textValues[3],ls`${this._textLabels.textContent.charAt(3)} in ${this._textLabels.textContent}`),this._textValues[3].value=Math.round(100*o[3])/100}}_updateUI(){const t=e.Color.fromHSVA([this._hsv[0],1,1,1]);this._colorElement.style.backgroundColor=t.asString(e.Format.RGB),this._contrastOverlay&&this._contrastOverlay.setDimensions(this.dragWidth,this.dragHeight),this._swatch.setColor(this._color(),this.colorString()),this._colorDragElement.style.backgroundColor=this._color().asString(e.Format.RGBA);const o=e.Color.fromHSVA(this._hsv.slice(0,3).concat(1));this._alphaElementBackground.style.backgroundImage=C.sprintf("linear-gradient(to right, rgba(0,0,0,0), %s)",o.asString(e.Format.RGB))}_formatViewSwitch(){const t=e.Format;let o=t.RGB;this._colorFormat===t.RGB?o=t.HSL:this._colorFormat===t.HSL&&(o=this._originalFormat===t.ShortHEX||this._originalFormat===t.ShortHEXA?t.ShortHEX:t.HEX),this._innerSetColor(void 0,"",void 0,o,y.Other)}_pasted(t){if(!t.clipboardData)return;const o=t.clipboardData.getData("text"),s=e.Color.parse(o);s&&(this._innerSetColor(s.hsva(),o,void 0,void 0,y.Other),t.preventDefault())}_inputChanged(t){function o(t){return t.value}const s=t.currentTarget,i=h.createReplacementString(s.value,t);i&&(s.value=i,s.selectionStart=0,s.selectionEnd=i.length,t.consume(!0));const n=e.Format;let a;if(this._colorFormat===n.Nickname||this._colorFormat===n.HEX||this._colorFormat===n.ShortHEX)a=this._hexValue.value;else{const t=this._colorFormat===n.RGB?"rgb":"hsl",e=this._textValues.slice(0,-1).map(o).join(" "),s=this._textValues.slice(-1).map(o).join(" ");a=C.sprintf("%s(%s)",t,[e,s].join(" / "))}const r=e.Color.parse(a);if(!r)return;let l=void 0;this._colorFormat!==n.HEX&&this._colorFormat!==n.ShortHEX||(l=r.detectHEXFormat()),this._innerSetColor(r.hsva(),a,void 0,l,y.Input)}wasShown(){this._hueAlphaWidth=this._hueElement.offsetWidth,this.slideHelperWidth=this._hueSlider.offsetWidth/2,this.dragWidth=this._colorElement.offsetWidth,this.dragHeight=this._colorElement.offsetHeight,this._colorDragElementHeight=this._colorDragElement.offsetHeight/2,this._innerSetColor(void 0,void 0,void 0,void 0,y.Model),this._toggleColorPicker(!0),this._contrastDetails&&this._contrastDetails.addEventListener(w.BackgroundColorPickerWillBeToggled,this._contrastDetailsBackgroundColorPickedToggledBound)}willHide(){this._toggleColorPicker(!1),this._contrastDetails&&this._contrastDetails.removeEventListener(w.BackgroundColorPickerWillBeToggled,this._contrastDetailsBackgroundColorPickedToggledBound)}_toggleColorPicker(t,e){void 0===t&&(t=!this._colorPickerButton.toggled()),this._colorPickerButton.setToggled(t),this._contrastDetails&&t&&this._contrastDetails.backgroundColorPickerEnabled()&&this._contrastDetails.toggleBackgroundColorPicker(!1),r.InspectorFrontendHostInstance.setEyeDropperActive(t),t?r.InspectorFrontendHostInstance.events.addEventListener(l.Events.EyeDropperPickedColor,this._colorPickedBound):r.InspectorFrontendHostInstance.events.removeEventListener(l.Events.EyeDropperPickedColor,this._colorPickedBound)}_colorPicked(t){const o=t.data,s=[o.r,o.g,o.b,(o.a/2.55|0)/100],i=e.Color.fromRGBA(s);this._innerSetColor(i.hsva(),"",void 0,void 0,y.Other),r.InspectorFrontendHostInstance.bringToFront()}}const y={Input:"Input",Model:"Model",Other:"Other"},L={ColorChanged:Symbol("ColorChanged"),SizeChanged:Symbol("SizeChanged")},D=24,T=8,H="Page colors";class R{constructor(t){this._callback=t,this._frequencyMap=new Map;const e=[];for(const t of m.TargetManager.instance().models(E.CSSModel))for(const o of t.allStyleSheets())e.push(this._processStylesheet(o));Promise.all(e).catch(t=>{console.error(t)}).then(this._finish.bind(this))}_frequencyComparator(t,e){return this._frequencyMap.get(e)-this._frequencyMap.get(t)}_finish(){let t=[...this._frequencyMap.keys()];t=t.sort(this._frequencyComparator.bind(this));const o=new Map;for(;o.size<24&&t.length;){const s=t.shift(),i=e.Color.parse(s);i&&"white"!==i.nickname()&&"black"!==i.nickname()&&o.set(s,i)}this._callback({title:H,colors:[...o.keys()].sort((function(t,e){const s=o.get(t).hsva(),i=o.get(e).hsva();return i[1]<.12&&s[1]<.12?i[2]*i[3]-s[2]*s[3]:i[1]<.12?-1:s[1]<.12?1:i[0]===s[0]?i[1]*i[3]-s[1]*s[3]:(i[0]+.94)%1-(s[0]+.94)%1})),colorNames:[],mutable:!1})}async _processStylesheet(t){let e=(await t.requestContent()).content||"";e=e.toLowerCase();const o=e.match(/((?:rgb|hsl)a?\([^)]+\)|#[0-9a-f]{6}|#[0-9a-f]{3})/g)||[];for(const t of o){let e=this._frequencyMap.get(t)||0;this._frequencyMap.set(t,++e)}}}const V={"#F44336":["#FFEBEE","#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828","#B71C1C"],"#E91E63":["#FCE4EC","#F8BBD0","#F48FB1","#F06292","#EC407A","#E91E63","#D81B60","#C2185B","#AD1457","#880E4F"],"#9C27B0":["#F3E5F5","#E1BEE7","#CE93D8","#BA68C8","#AB47BC","#9C27B0","#8E24AA","#7B1FA2","#6A1B9A","#4A148C"],"#673AB7":["#EDE7F6","#D1C4E9","#B39DDB","#9575CD","#7E57C2","#673AB7","#5E35B1","#512DA8","#4527A0","#311B92"],"#3F51B5":["#E8EAF6","#C5CAE9","#9FA8DA","#7986CB","#5C6BC0","#3F51B5","#3949AB","#303F9F","#283593","#1A237E"],"#2196F3":["#E3F2FD","#BBDEFB","#90CAF9","#64B5F6","#42A5F5","#2196F3","#1E88E5","#1976D2","#1565C0","#0D47A1"],"#03A9F4":["#E1F5FE","#B3E5FC","#81D4FA","#4FC3F7","#29B6F6","#03A9F4","#039BE5","#0288D1","#0277BD","#01579B"],"#00BCD4":["#E0F7FA","#B2EBF2","#80DEEA","#4DD0E1","#26C6DA","#00BCD4","#00ACC1","#0097A7","#00838F","#006064"],"#009688":["#E0F2F1","#B2DFDB","#80CBC4","#4DB6AC","#26A69A","#009688","#00897B","#00796B","#00695C","#004D40"],"#4CAF50":["#E8F5E9","#C8E6C9","#A5D6A7","#81C784","#66BB6A","#4CAF50","#43A047","#388E3C","#2E7D32","#1B5E20"],"#8BC34A":["#F1F8E9","#DCEDC8","#C5E1A5","#AED581","#9CCC65","#8BC34A","#7CB342","#689F38","#558B2F","#33691E"],"#CDDC39":["#F9FBE7","#F0F4C3","#E6EE9C","#DCE775","#D4E157","#CDDC39","#C0CA33","#AFB42B","#9E9D24","#827717"],"#FFEB3B":["#FFFDE7","#FFF9C4","#FFF59D","#FFF176","#FFEE58","#FFEB3B","#FDD835","#FBC02D","#F9A825","#F57F17"],"#FFC107":["#FFF8E1","#FFECB3","#FFE082","#FFD54F","#FFCA28","#FFC107","#FFB300","#FFA000","#FF8F00","#FF6F00"],"#FF9800":["#FFF3E0","#FFE0B2","#FFCC80","#FFB74D","#FFA726","#FF9800","#FB8C00","#F57C00","#EF6C00","#E65100"],"#FF5722":["#FBE9E7","#FFCCBC","#FFAB91","#FF8A65","#FF7043","#FF5722","#F4511E","#E64A19","#D84315","#BF360C"],"#795548":["#EFEBE9","#D7CCC8","#BCAAA4","#A1887F","#8D6E63","#795548","#6D4C41","#5D4037","#4E342E","#3E2723"],"#9E9E9E":["#FAFAFA","#F5F5F5","#EEEEEE","#E0E0E0","#BDBDBD","#9E9E9E","#757575","#616161","#424242","#212121"],"#607D8B":["#ECEFF1","#CFD8DC","#B0BEC5","#90A4AE","#78909C","#607D8B","#546E7A","#455A64","#37474F","#263238"]},M={title:"Material",mutable:!1,matchUserFormat:!0,colors:Object.keys(V),colorNames:[]};class O{constructor(t){this._colorString;const e=t.createChild("span","swatch");this._swatchInnerElement=e.createChild("span","swatch-inner"),this._swatchOverlayElement=e.createChild("span","swatch-overlay"),_.markAsButton(this._swatchOverlayElement),_.setPressed(this._swatchOverlayElement,!1),this._swatchOverlayElement.tabIndex=0,self.onInvokeElement(this._swatchOverlayElement,this._onCopyText.bind(this)),this._swatchOverlayElement.addEventListener("mouseout",this._onCopyIconMouseout.bind(this)),this._swatchOverlayElement.addEventListener("blur",this._onCopyIconMouseout.bind(this)),this._swatchCopyIcon=c.Icon.create("largeicon-copy","copy-color-icon"),this._swatchCopyIcon.title=ls`Copy color to clipboard`,this._swatchOverlayElement.appendChild(this._swatchCopyIcon),_.setAccessibleName(this._swatchOverlayElement,this._swatchCopyIcon.title)}setColor(t,o){this._swatchInnerElement.style.backgroundColor=t.asString(e.Format.RGBA),this._swatchInnerElement.classList.toggle("swatch-inner-white",t.hsla()[2]>.9),this._colorString=o||null,this._swatchOverlayElement.hidden=!o}_onCopyText(t){this._swatchCopyIcon.setIconType("largeicon-checkmark"),r.InspectorFrontendHostInstance.copyText(this._colorString),_.setPressed(this._swatchOverlayElement,!0),t.consume()}_onCopyIconMouseout(){this._swatchCopyIcon.setIconType("largeicon-copy"),_.setPressed(this._swatchOverlayElement,!1)}}var N=Object.freeze({__proto__:null,Spectrum:I,ChangeSource:y,Events:L,PaletteGenerator:R,MaterialPaletteShades:V,MaterialPalette:M,Swatch:O,Palette:void 0});export{S as ContrastDetails,F as ContrastInfo,P as ContrastOverlay,N as Spectrum};
