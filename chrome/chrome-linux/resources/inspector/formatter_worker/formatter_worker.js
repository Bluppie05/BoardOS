import"../cm_headless/cm_headless.js";import{StringUtilities as t}from"../platform/platform.js";import{Runtime as e}from"../root/root.js";import{tokenizer as i,tokTypes as r,parse as n}from"../third_party/acorn/acorn.js";import{TextCursor as s}from"../text_utils/text_utils.js";import{tokTypes as a,SourceLocation as o,Node as l,lineBreak as p,isNewLine as h,Parser as c,Token as u,getLineInfo as d,lineBreakG as m,defaultOptions as f}from"../third_party/acorn/package/dist/acorn.mjs";var g;g=function(t){function e(t){for(var e={},i=0;i<t.length;++i)e[t[i].toLowerCase()]=!0;return e}t.defineMode("css",(function(e,i){var r=i.inline;i.propertyKeywords||(i=t.resolveMode("text/css"));var n,s,a=e.indentUnit,o=i.tokenHooks,l=i.documentTypes||{},p=i.mediaTypes||{},h=i.mediaFeatures||{},c=i.mediaValueKeywords||{},u=i.propertyKeywords||{},d=i.nonStandardPropertyKeywords||{},m=i.fontProperties||{},f=i.counterDescriptors||{},g=i.colorKeywords||{},y=i.valueKeywords||{},b=i.allowNested,k=i.lineComment,x=!0===i.supportsAtComponent;function w(t,e){return n=e,t}function v(t,e){var i=t.next();if(o[i]){var r=o[i](t,e);if(!1!==r)return r}return"@"==i?(t.eatWhile(/[\w\\\-]/),w("def",t.current())):"="==i||("~"==i||"|"==i)&&t.eat("=")?w(null,"compare"):'"'==i||"'"==i?(e.tokenize=_(i),e.tokenize(t,e)):"#"==i?(t.eatWhile(/[\w\\\-]/),w("atom","hash")):"!"==i?(t.match(/^\s*\w*/),w("keyword","important")):/\d/.test(i)||"."==i&&t.eat(/\d/)?(t.eatWhile(/[\w.%]/),w("number","unit")):"-"!==i?/[,+>*\/]/.test(i)?w(null,"select-op"):"."==i&&t.match(/^-?[_a-z][_a-z0-9-]*/i)?w("qualifier","qualifier"):/[:;{}\[\]\(\)]/.test(i)?w(null,i):t.match(/[\w-.]+(?=\()/)?(/^(url(-prefix)?|domain|regexp)$/.test(t.current().toLowerCase())&&(e.tokenize=S),w("variable callee","variable")):/[\w\\\-]/.test(i)?(t.eatWhile(/[\w\\\-]/),w("property","word")):w(null,null):/[\d.]/.test(t.peek())?(t.eatWhile(/[\w.%]/),w("number","unit")):t.match(/^-[\w\\\-]*/)?(t.eatWhile(/[\w\\\-]/),t.match(/^\s*:/,!1)?w("variable-2","variable-definition"):w("variable-2","variable")):t.match(/^\w+-/)?w("meta","meta"):void 0}function _(t){return function(e,i){for(var r,n=!1;null!=(r=e.next());){if(r==t&&!n){")"==t&&e.backUp(1);break}n=!n&&"\\"==r}return(r==t||!n&&")"!=t)&&(i.tokenize=null),w("string","string")}}function S(t,e){return t.next(),t.match(/\s*[\"\')]/,!1)?e.tokenize=null:e.tokenize=_(")"),w(null,"(")}function N(t,e,i){this.type=t,this.indent=e,this.prev=i}function E(t,e,i,r){return t.context=new N(i,e.indentation()+(!1===r?0:a),t.context),i}function L(t){return t.context.prev&&(t.context=t.context.prev),t.context.type}function C(t,e,i){return A[i.context.type](t,e,i)}function T(t,e,i,r){for(var n=r||1;n>0;n--)i.context=i.context.prev;return C(t,e,i)}function I(t){var e=t.current().toLowerCase();s=y.hasOwnProperty(e)?"atom":g.hasOwnProperty(e)?"keyword":"variable"}var A={top:function(t,e,i){if("{"==t)return E(i,e,"block");if("}"==t&&i.context.prev)return L(i);if(x&&/@component/i.test(t))return E(i,e,"atComponentBlock");if(/^@(-moz-)?document$/i.test(t))return E(i,e,"documentTypes");if(/^@(media|supports|(-moz-)?document|import)$/i.test(t))return E(i,e,"atBlock");if(/^@(font-face|counter-style)/i.test(t))return i.stateArg=t,"restricted_atBlock_before";if(/^@(-(moz|ms|o|webkit)-)?keyframes$/i.test(t))return"keyframes";if(t&&"@"==t.charAt(0))return E(i,e,"at");if("hash"==t)s="builtin";else if("word"==t)s="tag";else{if("variable-definition"==t)return"maybeprop";if("interpolation"==t)return E(i,e,"interpolation");if(":"==t)return"pseudo";if(b&&"("==t)return E(i,e,"parens")}return i.context.type},block:function(t,e,i){if("word"==t){var r=e.current().toLowerCase();return u.hasOwnProperty(r)?(s="property","maybeprop"):d.hasOwnProperty(r)?(s="string-2","maybeprop"):b?(s=e.match(/^\s*:(?:\s|$)/,!1)?"property":"tag","block"):(s+=" error","maybeprop")}return"meta"==t?"block":b||"hash"!=t&&"qualifier"!=t?A.top(t,e,i):(s="error","block")},maybeprop:function(t,e,i){return":"==t?E(i,e,"prop"):C(t,e,i)},prop:function(t,e,i){if(";"==t)return L(i);if("{"==t&&b)return E(i,e,"propBlock");if("}"==t||"{"==t)return T(t,e,i);if("("==t)return E(i,e,"parens");if("hash"!=t||/^#([0-9a-fA-f]{3,4}|[0-9a-fA-f]{6}|[0-9a-fA-f]{8})$/.test(e.current())){if("word"==t)I(e);else if("interpolation"==t)return E(i,e,"interpolation")}else s+=" error";return"prop"},propBlock:function(t,e,i){return"}"==t?L(i):"word"==t?(s="property","maybeprop"):i.context.type},parens:function(t,e,i){return"{"==t||"}"==t?T(t,e,i):")"==t?L(i):"("==t?E(i,e,"parens"):"interpolation"==t?E(i,e,"interpolation"):("word"==t&&I(e),"parens")},pseudo:function(t,e,i){return"meta"==t?"pseudo":"word"==t?(s="variable-3",i.context.type):C(t,e,i)},documentTypes:function(t,e,i){return"word"==t&&l.hasOwnProperty(e.current())?(s="tag",i.context.type):A.atBlock(t,e,i)},atBlock:function(t,e,i){if("("==t)return E(i,e,"atBlock_parens");if("}"==t||";"==t)return T(t,e,i);if("{"==t)return L(i)&&E(i,e,b?"block":"top");if("interpolation"==t)return E(i,e,"interpolation");if("word"==t){var r=e.current().toLowerCase();s="only"==r||"not"==r||"and"==r||"or"==r?"keyword":p.hasOwnProperty(r)?"attribute":h.hasOwnProperty(r)?"property":c.hasOwnProperty(r)?"keyword":u.hasOwnProperty(r)?"property":d.hasOwnProperty(r)?"string-2":y.hasOwnProperty(r)?"atom":g.hasOwnProperty(r)?"keyword":"error"}return i.context.type},atComponentBlock:function(t,e,i){return"}"==t?T(t,e,i):"{"==t?L(i)&&E(i,e,b?"block":"top",!1):("word"==t&&(s="error"),i.context.type)},atBlock_parens:function(t,e,i){return")"==t?L(i):"{"==t||"}"==t?T(t,e,i,2):A.atBlock(t,e,i)},restricted_atBlock_before:function(t,e,i){return"{"==t?E(i,e,"restricted_atBlock"):"word"==t&&"@counter-style"==i.stateArg?(s="variable","restricted_atBlock_before"):C(t,e,i)},restricted_atBlock:function(t,e,i){return"}"==t?(i.stateArg=null,L(i)):"word"==t?(s="@font-face"==i.stateArg&&!m.hasOwnProperty(e.current().toLowerCase())||"@counter-style"==i.stateArg&&!f.hasOwnProperty(e.current().toLowerCase())?"error":"property","maybeprop"):"restricted_atBlock"},keyframes:function(t,e,i){return"word"==t?(s="variable","keyframes"):"{"==t?E(i,e,"top"):C(t,e,i)},at:function(t,e,i){return";"==t?L(i):"{"==t||"}"==t?T(t,e,i):("word"==t?s="tag":"hash"==t&&(s="builtin"),"at")},interpolation:function(t,e,i){return"}"==t?L(i):"{"==t||";"==t?T(t,e,i):("word"==t?s="variable":"variable"!=t&&"("!=t&&")"!=t&&(s="error"),"interpolation")}};return{startState:function(t){return{tokenize:null,state:r?"block":"top",stateArg:null,context:new N(r?"block":"top",t||0,null)}},token:function(t,e){if(!e.tokenize&&t.eatSpace())return null;var i=(e.tokenize||v)(t,e);return i&&"object"==typeof i&&(n=i[1],i=i[0]),s=i,"comment"!=n&&(e.state=A[e.state](n,t,e)),s},indent:function(t,e){var i=t.context,r=e&&e.charAt(0),n=i.indent;return"prop"!=i.type||"}"!=r&&")"!=r||(i=i.prev),i.prev&&("}"!=r||"block"!=i.type&&"top"!=i.type&&"interpolation"!=i.type&&"restricted_atBlock"!=i.type?(")"!=r||"parens"!=i.type&&"atBlock_parens"!=i.type)&&("{"!=r||"at"!=i.type&&"atBlock"!=i.type)||(n=Math.max(0,i.indent-a)):n=(i=i.prev).indent),n},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",lineComment:k,fold:"brace"}}));var i=["domain","regexp","url","url-prefix"],r=e(i),n=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],s=e(n),a=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid","orientation","device-pixel-ratio","min-device-pixel-ratio","max-device-pixel-ratio","pointer","any-pointer","hover","any-hover","prefers-color-scheme"],o=e(a),l=["landscape","portrait","none","coarse","fine","on-demand","hover","interlace","progressive","dark","light"],p=e(l),h=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","all","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","binding","bleed","block-size","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-gap","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","inset","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","left","letter-spacing","line-break","line-height","line-height-step","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","place-content","place-items","place-self","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotate","rotation","rotation-point","row-gap","ruby-align","ruby-overhang","ruby-position","ruby-span","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-type","shape-image-threshold","shape-inside","shape-margin","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-orientation","text-outline","text-overflow","text-rendering","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","touch-action","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-select","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","paint-order","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","text-anchor","writing-mode"],c=e(h),u=["border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","margin-block","margin-block-end","margin-block-start","margin-inline","margin-inline-end","margin-inline-start","padding-block","padding-block-end","padding-block-start","padding-inline","padding-inline-end","padding-inline-start","scroll-snap-stop","scrollbar-3d-light-color","scrollbar-arrow-color","scrollbar-base-color","scrollbar-dark-shadow-color","scrollbar-face-color","scrollbar-highlight-color","scrollbar-shadow-color","scrollbar-track-color","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","shape-inside","zoom"],d=e(u),m=e(["font-display","font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"]),f=e(["additive-symbols","fallback","negative","pad","prefix","range","speak-as","suffix","symbols","system"]),g=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],y=e(g),b=["above","absolute","activeborder","additive","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","devanagari","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ethiopic-numeric","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","georgian","graytext","grid","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hard-light","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","japanese-formal","japanese-informal","justify","kannada","katakana","katakana-iroha","keep-all","khmer","korean-hangul-formal","korean-hanja-formal","korean-hanja-informal","landscape","lao","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","luminosity","malayalam","manipulation","match","matrix","matrix3d","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","multiple_mask_images","multiply","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","octal","opacity","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","sidama","simp-chinese-formal","simp-chinese-informal","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","somali","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","square-button","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","tamil","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","trad-chinese-formal","trad-chinese-informal","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"],k=e(b),x=i.concat(n).concat(a).concat(l).concat(h).concat(u).concat(g).concat(b);function w(t,e){for(var i,r=!1;null!=(i=t.next());){if(r&&"/"==i){e.tokenize=null;break}r="*"==i}return["comment","comment"]}t.registerHelper("hintWords","css",x),t.defineMIME("text/css",{documentTypes:r,mediaTypes:s,mediaFeatures:o,mediaValueKeywords:p,propertyKeywords:c,nonStandardPropertyKeywords:d,fontProperties:m,counterDescriptors:f,colorKeywords:y,valueKeywords:k,tokenHooks:{"/":function(t,e){return!!t.eat("*")&&(e.tokenize=w,w(t,e))}},name:"css"}),t.defineMIME("text/x-scss",{mediaTypes:s,mediaFeatures:o,mediaValueKeywords:p,propertyKeywords:c,nonStandardPropertyKeywords:d,colorKeywords:y,valueKeywords:k,fontProperties:m,allowNested:!0,lineComment:"//",tokenHooks:{"/":function(t,e){return t.eat("/")?(t.skipToEnd(),["comment","comment"]):t.eat("*")?(e.tokenize=w,w(t,e)):["operator","operator"]},":":function(t){return!!t.match(/\s*\{/,!1)&&[null,null]},$:function(t){return t.match(/^[\w-]+/),t.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"]},"#":function(t){return!!t.eat("{")&&[null,"interpolation"]}},name:"css",helperType:"scss"}),t.defineMIME("text/x-less",{mediaTypes:s,mediaFeatures:o,mediaValueKeywords:p,propertyKeywords:c,nonStandardPropertyKeywords:d,colorKeywords:y,valueKeywords:k,fontProperties:m,allowNested:!0,lineComment:"//",tokenHooks:{"/":function(t,e){return t.eat("/")?(t.skipToEnd(),["comment","comment"]):t.eat("*")?(e.tokenize=w,w(t,e)):["operator","operator"]},"@":function(t){return t.eat("{")?[null,"interpolation"]:!t.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/i,!1)&&(t.eatWhile(/[\w\\\-]/),t.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"])},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"}),t.defineMIME("text/x-gss",{documentTypes:r,mediaTypes:s,mediaFeatures:o,propertyKeywords:c,nonStandardPropertyKeywords:d,fontProperties:m,counterDescriptors:f,colorKeywords:y,valueKeywords:k,supportsAtComponent:!0,tokenHooks:{"/":function(t,e){return!!t.eat("*")&&(e.tokenize=w,w(t,e))}},name:"css",helperType:"gss"})},"object"==typeof exports&&"object"==typeof module?g(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],g):g(CodeMirror),function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}((function(t){var e={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},i={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,allowMissingTagName:!1,caseFold:!1};t.defineMode("xml",(function(r,n){var s,a,o=r.indentUnit,l={},p=n.htmlMode?e:i;for(var h in p)l[h]=p[h];for(var h in n)l[h]=n[h];function c(t,e){function i(i){return e.tokenize=i,i(t,e)}var r=t.next();return"<"==r?t.eat("!")?t.eat("[")?t.match("CDATA[")?i(d("atom","]]>")):null:t.match("--")?i(d("comment","--\x3e")):t.match("DOCTYPE",!0,!0)?(t.eatWhile(/[\w\._\-]/),i(function t(e){return function(i,r){for(var n;null!=(n=i.next());){if("<"==n)return r.tokenize=t(e+1),r.tokenize(i,r);if(">"==n){if(1==e){r.tokenize=c;break}return r.tokenize=t(e-1),r.tokenize(i,r)}}return"meta"}}(1))):null:t.eat("?")?(t.eatWhile(/[\w\._\-]/),e.tokenize=d("meta","?>"),"meta"):(s=t.eat("/")?"closeTag":"openTag",e.tokenize=u,"tag bracket"):"&"==r?(t.eat("#")?t.eat("x")?t.eatWhile(/[a-fA-F\d]/)&&t.eat(";"):t.eatWhile(/[\d]/)&&t.eat(";"):t.eatWhile(/[\w\.\-:]/)&&t.eat(";"))?"atom":"error":(t.eatWhile(/[^&<]/),null)}function u(t,e){var i,r,n=t.next();if(">"==n||"/"==n&&t.eat(">"))return e.tokenize=c,s=">"==n?"endTag":"selfcloseTag","tag bracket";if("="==n)return s="equals",null;if("<"==n){e.tokenize=c,e.state=y,e.tagName=e.tagStart=null;var a=e.tokenize(t,e);return a?a+" tag error":"tag error"}return/[\'\"]/.test(n)?(e.tokenize=(i=n,(r=function(t,e){for(;!t.eol();)if(t.next()==i){e.tokenize=u;break}return"string"}).isInAttribute=!0,r),e.stringStartCol=t.column(),e.tokenize(t,e)):(t.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function d(t,e){return function(i,r){for(;!i.eol();){if(i.match(e)){r.tokenize=c;break}i.next()}return t}}function m(t,e,i){this.prev=t.context,this.tagName=e,this.indent=t.indented,this.startOfLine=i,(l.doNotIndent.hasOwnProperty(e)||t.context&&t.context.noIndent)&&(this.noIndent=!0)}function f(t){t.context&&(t.context=t.context.prev)}function g(t,e){for(var i;;){if(!t.context)return;if(i=t.context.tagName,!l.contextGrabbers.hasOwnProperty(i)||!l.contextGrabbers[i].hasOwnProperty(e))return;f(t)}}function y(t,e,i){return"openTag"==t?(i.tagStart=e.column(),b):"closeTag"==t?k:y}function b(t,e,i){return"word"==t?(i.tagName=e.current(),a="tag",v):l.allowMissingTagName&&"endTag"==t?(a="tag bracket",v(t,e,i)):(a="error",b)}function k(t,e,i){if("word"==t){var r=e.current();return i.context&&i.context.tagName!=r&&l.implicitlyClosed.hasOwnProperty(i.context.tagName)&&f(i),i.context&&i.context.tagName==r||!1===l.matchClosing?(a="tag",x):(a="tag error",w)}return l.allowMissingTagName&&"endTag"==t?(a="tag bracket",x(t,e,i)):(a="error",w)}function x(t,e,i){return"endTag"!=t?(a="error",x):(f(i),y)}function w(t,e,i){return a="error",x(t,0,i)}function v(t,e,i){if("word"==t)return a="attribute",_;if("endTag"==t||"selfcloseTag"==t){var r=i.tagName,n=i.tagStart;return i.tagName=i.tagStart=null,"selfcloseTag"==t||l.autoSelfClosers.hasOwnProperty(r)?g(i,r):(g(i,r),i.context=new m(i,r,n==i.indented)),y}return a="error",v}function _(t,e,i){return"equals"==t?S:(l.allowMissing||(a="error"),v(t,0,i))}function S(t,e,i){return"string"==t?N:"word"==t&&l.allowUnquoted?(a="string",v):(a="error",v(t,0,i))}function N(t,e,i){return"string"==t?N:v(t,0,i)}return c.isInText=!0,{startState:function(t){var e={tokenize:c,state:y,indented:t||0,tagName:null,tagStart:null,context:null};return null!=t&&(e.baseIndent=t),e},token:function(t,e){if(!e.tagName&&t.sol()&&(e.indented=t.indentation()),t.eatSpace())return null;s=null;var i=e.tokenize(t,e);return(i||s)&&"comment"!=i&&(a=null,e.state=e.state(s||i,t,e),a&&(i="error"==a?i+" error":a)),i},indent:function(e,i,r){var n=e.context;if(e.tokenize.isInAttribute)return e.tagStart==e.indented?e.stringStartCol+1:e.indented+o;if(n&&n.noIndent)return t.Pass;if(e.tokenize!=u&&e.tokenize!=c)return r?r.match(/^(\s*)/)[0].length:0;if(e.tagName)return!1!==l.multilineTagIndentPastTag?e.tagStart+e.tagName.length+2:e.tagStart+o*(l.multilineTagIndentFactor||1);if(l.alignCDATA&&/<!\[CDATA\[/.test(i))return 0;var s=i&&/^<(\/)?([\w_:\.-]*)/.exec(i);if(s&&s[1])for(;n;){if(n.tagName==s[2]){n=n.prev;break}if(!l.implicitlyClosed.hasOwnProperty(n.tagName))break;n=n.prev}else if(s)for(;n;){var a=l.contextGrabbers[n.tagName];if(!a||!a.hasOwnProperty(s[2]))break;n=n.prev}for(;n&&n.prev&&!n.startOfLine;)n=n.prev;return n?n.indent+o:e.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",configuration:l.htmlMode?"html":"xml",helperType:l.htmlMode?"html":"xml",skipAttribute:function(t){t.state==S&&(t.state=v)},xmlCurrentTag:function(t){return t.tagName?{name:t.tagName,close:"closeTag"==t.type}:null},xmlCurrentContext:function(t){for(var e=[],i=t.context;i;i=i.prev)i.tagName&&e.push(i.tagName);return e.reverse()}}})),t.defineMIME("text/xml","xml"),t.defineMIME("application/xml","xml"),t.mimeModes.hasOwnProperty("text/html")||t.defineMIME("text/html",{name:"xml",htmlMode:!0})}));class y{constructor(e){this._content=e,this._comments=[],this._tokenizer=i(this._content,{onComment:this._comments,ecmaVersion:b});const r=t.findLineEndingIndexes(this._content);this._textCursor=new s.TextCursor(r),this._tokenLineStart=0,this._tokenLineEnd=0,this._tokenColumnStart=0,this._nextTokenInternal()}static punctuator(t,e){return t.type!==r.num&&t.type!==r.regexp&&t.type!==r.string&&t.type!==r.name&&!t.type.keyword&&(!e||1===t.type.label.length&&-1!==e.indexOf(t.type.label))}static keyword(t,e){return!(!t.type.keyword||t.type===r._true||t.type===r._false||t.type===r._null||e&&t.type.keyword!==e)}static identifier(t,e){return t.type===r.name&&(!e||t.value===e)}static lineComment(t){return"Line"===t.type}static blockComment(t){return"Block"===t.type}_nextTokenInternal(){if(this._comments.length)return this._comments.shift();const t=this._bufferedToken;return this._bufferedToken=this._tokenizer.getToken(),t}nextToken(){const t=this._nextTokenInternal();return t.type===r.eof?null:(this._textCursor.advance(t.start),this._tokenLineStart=this._textCursor.lineNumber(),this._tokenColumnStart=this._textCursor.columnNumber(),this._textCursor.advance(t.end),this._tokenLineEnd=this._textCursor.lineNumber(),t)}peekToken(){return this._comments.length?this._comments[0]:this._bufferedToken&&this._bufferedToken.type!==r.eof?this._bufferedToken:null}tokenLineStart(){return this._tokenLineStart}tokenLineEnd(){return this._tokenLineEnd}tokenColumnStart(){return this._tokenColumnStart}}const b=11;class k{constructor(t){this._builder=t,this._toOffset,this._fromOffset,this._lineEndings,this._lastLine=-1,this._state={eatWhitespace:void 0,seenProperty:void 0,inPropertyValue:void 0,afterClosingBrace:void 0}}format(t,e,i,r){this._lineEndings=e,this._fromOffset=i,this._toOffset=r,this._state={eatWhitespace:void 0,seenProperty:void 0,inPropertyValue:void 0,afterClosingBrace:void 0},this._lastLine=-1;const n=z("text/css"),s=this._builder.setEnforceSpaceBetweenWords(!1);n(t.substring(this._fromOffset,this._toOffset),this._tokenCallback.bind(this)),this._builder.setEnforceSpaceBetweenWords(s)}_tokenCallback(t,e,i){i+=this._fromOffset;const r=this._lineEndings.lowerBound(i);r!==this._lastLine&&(this._state.eatWhitespace=!0),e&&/^property/.test(e)&&!this._state.inPropertyValue&&(this._state.seenProperty=!0),this._lastLine=r;if(/^\s+$/.test(t))this._state.eatWhitespace||this._builder.addSoftSpace();else if(this._state.eatWhitespace=!1,"\n"!==t){if("}"!==t&&(this._state.afterClosingBrace&&this._builder.addNewLine(!0),this._state.afterClosingBrace=!1),"}"===t)this._state.inPropertyValue&&this._builder.addNewLine(),this._builder.decreaseNestingLevel(),this._state.afterClosingBrace=!0,this._state.inPropertyValue=!1;else{if(":"===t&&!this._state.inPropertyValue&&this._state.seenProperty)return this._builder.addToken(t,i),this._builder.addSoftSpace(),this._state.eatWhitespace=!0,this._state.inPropertyValue=!0,void(this._state.seenProperty=!1);if("{"===t)return this._builder.addSoftSpace(),this._builder.addToken(t,i),this._builder.addNewLine(),void this._builder.increaseNestingLevel()}this._builder.addToken(t,i),"comment"!==e||this._state.inPropertyValue||this._state.seenProperty||this._builder.addNewLine(),";"===t&&this._state.inPropertyValue?(this._state.inPropertyValue=!1,this._builder.addNewLine()):"}"===t&&this._builder.addNewLine()}}}const x={};class w{constructor(t,e){this._beforeVisit=t,this._afterVisit=e||new Function,this._walkNulls=!1}static get SkipSubtree(){return x}setWalkNulls(t){this._walkNulls=t}walk(t){this._innerWalk(t,null)}_innerWalk(t,e){if(!t&&e&&this._walkNulls){const e={raw:"null",value:null,parent:null,type:"Literal"};t=e}if(!t)return;if(t.parent=e,this._beforeVisit.call(null,t)===w.SkipSubtree)return void this._afterVisit.call(null,t);const i=v[t.type];if(i){if("TemplateLiteral"===t.type){const e=t,i=e.expressions.length;for(let t=0;t<i;++t)this._innerWalk(e.quasis[t],e),this._innerWalk(e.expressions[t],e);this._innerWalk(e.quasis[i],e)}else for(let e=0;e<i.length;++e){const r=t[i[e]];Array.isArray(r)?this._walkArray(r,t):this._innerWalk(r,t)}this._afterVisit.call(null,t)}else console.error("Walk order not defined for "+t.type)}_walkArray(t,e){for(let i=0;i<t.length;++i)this._innerWalk(t[i],e)}}const v={AwaitExpression:["argument"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],BinaryExpression:["left","right"],BlockStatement:["body"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ChainExpression:["expression"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExpressionStatement:["expression"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],ForStatement:["init","test","update","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],Identifier:[],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],ImportExpression:["source"],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["specifiers","source","declaration"],ExportSpecifier:["exported","local"],IfStatement:["test","consequent","alternate"],LabeledStatement:["label","body"],Literal:[],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],ParenthesizedExpression:["expression"],Program:["body"],Property:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchCase:["test","consequent"],SwitchStatement:["discriminant","cases"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]};class _{constructor(t){this.indentString=t,this.lastOriginalPosition=0,this.formattedContent=[],this.formattedContentLength=0,this.lastFormattedPosition=0,this.nestingLevel=0,this.newLines=0,this.enforceSpaceBetweenWords=!0,this.softSpace=!1,this.hardSpaces=0,this.cachedIndents=new Map,this.mapping={original:[0],formatted:[0]}}setEnforceSpaceBetweenWords(t){const e=this.enforceSpaceBetweenWords;return this.enforceSpaceBetweenWords=t,e}addToken(t,e){const i=this.formattedContent.peekLast();this.enforceSpaceBetweenWords&&i&&/\w/.test(i[i.length-1])&&/\w/.test(t)&&this.addSoftSpace(),this.appendFormatting(),this.addMappingIfNeeded(e),this.addText(t)}addSoftSpace(){this.hardSpaces||(this.softSpace=!0)}addHardSpace(){this.softSpace=!1,++this.hardSpaces}addNewLine(t){this.formattedContentLength&&(t?++this.newLines:this.newLines=this.newLines||1)}increaseNestingLevel(){this.nestingLevel+=1}decreaseNestingLevel(){this.nestingLevel>0&&(this.nestingLevel-=1)}content(){return this.formattedContent.join("")+(this.newLines?"\n":"")}appendFormatting(){if(this.newLines){for(let t=0;t<this.newLines;++t)this.addText("\n");this.addText(this.indent())}else this.softSpace&&this.addText(" ");if(this.hardSpaces)for(let t=0;t<this.hardSpaces;++t)this.addText(" ");this.newLines=0,this.softSpace=!1,this.hardSpaces=0}indent(){const t=this.cachedIndents.get(this.nestingLevel);if(t)return t;let e="";for(let t=0;t<this.nestingLevel;++t)e+=this.indentString;return this.nestingLevel<=20&&this.cachedIndents.set(this.nestingLevel,e),e}addText(t){this.formattedContent.push(t),this.formattedContentLength+=t.length}addMappingIfNeeded(t){t-this.lastOriginalPosition!=this.formattedContentLength-this.lastFormattedPosition&&(this.mapping.original.push(t),this.lastOriginalPosition=t,this.mapping.formatted.push(this.formattedContentLength),this.lastFormattedPosition=this.formattedContentLength)}}class S{constructor(t){this._builder=t,this._tokenizer,this._content,this._fromOffset,this._lastLineNumber}format(t,e,i,r){this._fromOffset=i,this._toOffset=r,this._content=t.substring(this._fromOffset,this._toOffset),this._lastLineNumber=0,this._tokenizer=new y(this._content);const s=n(this._content,{ranges:!1,preserveParens:!0,allowImportExportEverywhere:!0,ecmaVersion:b});new w(this._beforeVisit.bind(this),this._afterVisit.bind(this)).walk(s)}_push(t,e){for(let i=0;i<e.length;++i)"s"===e[i]?this._builder.addSoftSpace():"S"===e[i]?this._builder.addHardSpace():"n"===e[i]?this._builder.addNewLine():">"===e[i]?this._builder.increaseNestingLevel():"<"===e[i]?this._builder.decreaseNestingLevel():"t"===e[i]&&(this._tokenizer.tokenLineStart()-this._lastLineNumber>1&&this._builder.addNewLine(!0),this._lastLineNumber=this._tokenizer.tokenLineEnd(),t&&this._builder.addToken(this._content.substring(t.start,t.end),this._fromOffset+t.start))}_beforeVisit(t){if(!t.parent)return;let e;for(;(e=this._tokenizer.peekToken())&&e.start<t.start;){const e=this._tokenizer.nextToken(),i=this._formatToken(t.parent,e);this._push(e,i)}}_afterVisit(t){let e;for(;(e=this._tokenizer.peekToken())&&e.start<t.end;){const e=this._tokenizer.nextToken(),i=this._formatToken(t,e);this._push(e,i)}this._push(null,this._finishNode(t))}_inForLoopHeader(t){const e=t.parent;if(!e)return!1;if("ForStatement"===e.type){const i=e;return t===i.init||t===i.test||t===i.update}if("ForInStatement"===e.type||"ForOfStatement"===e.type){const i=e;return t===i.left||t===i.right}return!1}_formatToken(t,e){const i=y;if(i.lineComment(e))return"tn";if(i.blockComment(e))return"tn";const r=e;if("ContinueStatement"===t.type||"BreakStatement"===t.type)return t.label&&i.keyword(r)?"ts":"t";if("Identifier"===t.type)return"t";if("ReturnStatement"===t.type)return i.punctuator(r,";")?"t":t.argument?"ts":"t";if("AwaitExpression"===t.type)return i.punctuator(r,";")?"t":t.argument?"ts":"t";if("Property"===t.type)return i.punctuator(r,":")?"ts":"t";if("ArrayExpression"===t.type)return i.punctuator(r,",")?"ts":"t";if("LabeledStatement"===t.type){if(i.punctuator(r,":"))return"ts"}else if("LogicalExpression"===t.type||"AssignmentExpression"===t.type||"BinaryExpression"===t.type){if(i.punctuator(r)&&!i.punctuator(r,"()"))return"sts"}else if("ConditionalExpression"===t.type){if(i.punctuator(r,"?:"))return"sts"}else if("VariableDeclarator"===t.type){if(i.punctuator(r,"="))return"sts"}else if("ObjectPattern"===t.type){if(t.parent&&"VariableDeclarator"===t.parent.type&&i.punctuator(r,"{"))return"st";if(i.punctuator(r,","))return"ts"}else if("FunctionDeclaration"===t.type){if(i.punctuator(r,",)"))return"ts"}else if("FunctionExpression"===t.type){if(i.punctuator(r,",)"))return"ts";if(i.keyword(r,"function"))return t.id?"ts":"t"}else if("WithStatement"===t.type){if(i.punctuator(r,")"))return t.body&&"BlockStatement"===t.body.type?"ts":"tn>"}else if("SwitchStatement"===t.type){if(i.punctuator(r,"{"))return"tn>";if(i.punctuator(r,"}"))return"n<tn";if(i.punctuator(r,")"))return"ts"}else if("SwitchCase"===t.type){if(i.keyword(r,"case"))return"n<ts";if(i.keyword(r,"default"))return"n<t";if(i.punctuator(r,":"))return"tn>"}else if("VariableDeclaration"===t.type){if(i.punctuator(r,",")){let e=!0;const i=t.declarations;for(let t=0;t<i.length;++t)e=e&&!!i[t].init;return!this._inForLoopHeader(t)&&e?"nSSts":"ts"}}else if("BlockStatement"===t.type){if(i.punctuator(r,"{"))return t.body.length?"tn>":"t";if(i.punctuator(r,"}"))return t.body.length?"n<t":"t"}else if("CatchClause"===t.type){if(i.punctuator(r,")"))return"ts"}else if("ObjectExpression"===t.type){if(!t.properties.length)return"t";if(i.punctuator(r,"{"))return"tn>";if(i.punctuator(r,"}"))return"n<t";if(i.punctuator(r,","))return"tn"}else if("IfStatement"===t.type){if(i.punctuator(r,")"))return t.consequent&&"BlockStatement"===t.consequent.type?"ts":"tn>";if(i.keyword(r,"else")){const e=t.consequent&&"BlockStatement"===t.consequent.type?"st":"n<t";let i="n>";return!t.alternate||"BlockStatement"!==t.alternate.type&&"IfStatement"!==t.alternate.type||(i="s"),e+i}}else if("CallExpression"===t.type){if(i.punctuator(r,","))return"ts"}else{if("SequenceExpression"===t.type&&i.punctuator(r,","))return t.parent&&"SwitchCase"===t.parent.type?"ts":"tn";if("ForStatement"===t.type||"ForOfStatement"===t.type||"ForInStatement"===t.type){if(i.punctuator(r,";"))return"ts";if(i.keyword(r,"in")||i.identifier(r,"of"))return"sts";if(i.punctuator(r,")"))return t.body&&"BlockStatement"===t.body.type?"ts":"tn>"}else if("WhileStatement"===t.type){if(i.punctuator(r,")"))return t.body&&"BlockStatement"===t.body.type?"ts":"tn>"}else if("DoWhileStatement"===t.type){const e=t.body&&"BlockStatement"===t.body.type;if(i.keyword(r,"do"))return e?"ts":"tn>";if(i.keyword(r,"while"))return e?"sts":"n<ts"}else{if("ClassBody"===t.type)return i.punctuator(r,"{")?"stn>":i.punctuator(r,"}")?"<ntn":"t";if("YieldExpression"===t.type)return"t";if("Super"===t.type)return"t";if("ImportExpression"===t.type)return"t";if("ExportAllDeclaration"===t.type)return i.punctuator(r,"*")?"sts":"t";if("ExportNamedDeclaration"===t.type||"ImportDeclaration"===t.type)return i.punctuator(r,"{")?"st":i.punctuator(r,",")?"ts":i.punctuator(r,"}")?t.source?"ts":"t":i.punctuator(r,"*")?"sts":"t"}}return i.keyword(r)&&!i.keyword(r,"this")?"ts":"t"}_finishNode(t){if("WithStatement"===t.type){if(t.body&&"BlockStatement"!==t.body.type)return"n<"}else if("VariableDeclaration"===t.type){if(!this._inForLoopHeader(t))return"n"}else if("ForStatement"===t.type||"ForOfStatement"===t.type||"ForInStatement"===t.type){if(t.body&&"BlockStatement"!==t.body.type)return"n<"}else{if("BlockStatement"===t.type){if(t.parent&&"IfStatement"===t.parent.type){const e=t.parent;if(e.alternate&&e.consequent===t)return""}if(t.parent&&"FunctionExpression"===t.parent.type&&t.parent.parent&&"Property"===t.parent.parent.type)return"";if(t.parent&&"FunctionExpression"===t.parent.type&&t.parent.parent&&"VariableDeclarator"===t.parent.parent.type)return"";if(t.parent&&"FunctionExpression"===t.parent.type&&t.parent.parent&&"CallExpression"===t.parent.parent.type)return"";if(t.parent&&"DoWhileStatement"===t.parent.type)return"";if(t.parent&&"TryStatement"===t.parent.type){if(t.parent.block===t)return"s"}if(t.parent&&"CatchClause"===t.parent.type){const e=t.parent;if(e.parent&&e.parent.finalizer)return"s"}return"n"}if("WhileStatement"===t.type){if(t.body&&"BlockStatement"!==t.body.type)return"n<"}else if("IfStatement"===t.type){if(t.alternate){if("BlockStatement"!==t.alternate.type&&"IfStatement"!==t.alternate.type)return"<"}else if(t.consequent&&"BlockStatement"!==t.consequent.type)return"<"}else{if("BreakStatement"===t.type||"ContinueStatement"===t.type||"ThrowStatement"===t.type||"ReturnStatement"===t.type||"ExpressionStatement"===t.type)return"n";if("ImportDeclaration"===t.type||"ExportAllDeclaration"===t.type||"ExportDefaultDeclaration"===t.type||"ExportNamedDeclaration"===t.type)return"n"}}return""}}class N{constructor(t){this._builder=t,this._jsFormatter=new S(t),this._cssFormatter=new k(t)}format(t,e){this._text=t,this._lineEndings=e,this._model=new E(t),this._walk(this._model.document())}_formatTokensTill(t,e){if(!this._model)return;let i=this._model.peekToken();for(;i&&i.startOffset<e;){const e=this._model.nextToken();this._formatToken(t,e),i=this._model.peekToken()}}_walk(t){if(!t.openTag||!t.closeTag)throw new Error("Element is missing open or close tag");t.parent&&this._formatTokensTill(t.parent,t.openTag.startOffset),this._beforeOpenTag(t),this._formatTokensTill(t,t.openTag.endOffset),this._afterOpenTag(t);for(let e=0;e<t.children.length;++e)this._walk(t.children[e]);this._formatTokensTill(t,t.closeTag.startOffset),this._beforeCloseTag(t),this._formatTokensTill(t,t.closeTag.endOffset),this._afterCloseTag(t)}_beforeOpenTag(t){this._model&&t.children.length&&t!==this._model.document()&&this._builder.addNewLine()}_afterOpenTag(t){this._model&&t.children.length&&t!==this._model.document()&&(this._builder.increaseNestingLevel(),this._builder.addNewLine())}_beforeCloseTag(t){this._model&&t.children.length&&t!==this._model.document()&&(this._builder.decreaseNestingLevel(),this._builder.addNewLine())}_afterCloseTag(t){this._builder.addNewLine()}_formatToken(e,i){if(t.isWhitespace(i.value))return;if(i.type.has("comment")||i.type.has("meta"))return this._builder.addNewLine(),this._builder.addToken(i.value.trim(),i.startOffset),void this._builder.addNewLine();if(!e.openTag||!e.closeTag)return;const r=e.openTag.endOffset<=i.startOffset&&i.startOffset<e.closeTag.startOffset;return r&&"style"===e.name?(this._builder.addNewLine(),this._builder.increaseNestingLevel(),this._cssFormatter.format(this._text||"",this._lineEndings||[],i.startOffset,i.endOffset),void this._builder.decreaseNestingLevel()):r&&"script"===e.name?(this._builder.addNewLine(),this._builder.increaseNestingLevel(),this._scriptTagIsJavaScript(e)?this._jsFormatter.format(this._text||"",this._lineEndings||[],i.startOffset,i.endOffset):(this._builder.addToken(i.value,i.startOffset),this._builder.addNewLine()),void this._builder.decreaseNestingLevel()):(!r&&i.type.has("attribute")&&this._builder.addSoftSpace(),void this._builder.addToken(i.value,i.startOffset))}_scriptTagIsJavaScript(t){if(!t.openTag)return!0;if(!t.openTag.attributes.has("type"))return!0;let e=t.openTag.attributes.get("type");if(!e)return!0;e=e.toLowerCase();const i=/^(["\'])(.*)\1$/.exec(e.trim());return i&&(e=i[2]),N.SupportedJavaScriptMimeTypes.has(e.trim())}}N.SupportedJavaScriptMimeTypes=new Set(["application/ecmascript","application/javascript","application/x-ecmascript","application/x-javascript","text/ecmascript","text/javascript","text/javascript1.0","text/javascript1.1","text/javascript1.2","text/javascript1.3","text/javascript1.4","text/javascript1.5","text/jscript","text/livescript","text/x-ecmascript","text/x-javascript"]);class E{constructor(t){this._state=T.Initial,this._document=new P("document"),this._document.openTag=new A("document",0,0,new Map,!0,!1),this._document.closeTag=new A("document",t.length,t.length,new Map,!1,!1),this._stack=[this._document],this._tokens=[],this._tokenIndex=0,this._build(t),this._attributes=new Map,this._attributeName="",this._tagName="",this._isOpenTag=!1}_build(t){const e=z("text/html");let i=0;const r=t.toLowerCase();for(;e(t.substring(i),n.bind(this,i)),!(i>=t.length);){const e=this._stack.peekLast();if(!e)break;if(i=r.indexOf("</"+e.name,i),-1===i&&(i=t.length),!e.openTag)break;const n=e.openTag.endOffset,s=i,a=t.substring(n,s);this._tokens.push(new I(a,new Set,n,s))}for(;this._stack.length>1;){const e=this._stack.peekLast();if(!e)break;this._popElement(new A(e.name,t.length,t.length,new Map,!1,!1))}function n(t,e,r,n,s){n+=t,i=s+=t;const a=r?new Set(r.split(" ")):new Set,o=new I(e,a,n,s);this._tokens.push(o),this._updateDOM(o);const l=this._stack.peekLast();if(l&&("script"===l.name||"style"===l.name)&&l.openTag&&l.openTag.endOffset===i)return M}}_updateDOM(t){const e=T,i=t.value,r=t.type;switch(this._state){case e.Initial:return void(!r.has("bracket")||"<"!==i&&"</"!==i||(this._onStartTag(t),this._state=e.Tag));case e.Tag:return void(r.has("tag")&&!r.has("bracket")?this._tagName=i.trim().toLowerCase():r.has("attribute")?(this._attributeName=i.trim().toLowerCase(),this._attributes.set(this._attributeName,""),this._state=e.AttributeName):!r.has("bracket")||">"!==i&&"/>"!==i||(this._onEndTag(t),this._state=e.Initial));case e.AttributeName:return void(r.size||"="!==i?!r.has("bracket")||">"!==i&&"/>"!==i||(this._onEndTag(t),this._state=e.Initial):this._state=e.AttributeValue);case e.AttributeValue:return void(r.has("string")?(this._attributes.set(this._attributeName,i),this._state=e.Tag):!r.has("bracket")||">"!==i&&"/>"!==i||(this._onEndTag(t),this._state=e.Initial))}}_onStartTag(t){this._tagName="",this._tagStartOffset=t.startOffset,this._tagEndOffset=null,this._attributes=new Map,this._attributeName="",this._isOpenTag="<"===t.value}_onEndTag(t){this._tagEndOffset=t.endOffset;const e="/>"===t.value||L.has(this._tagName),i=new A(this._tagName,this._tagStartOffset||0,this._tagEndOffset,this._attributes,this._isOpenTag,e);this._onTagComplete(i)}_onTagComplete(t){if(t.isOpenTag){const e=this._stack.peekLast();if(e){const r=C.get(e.name);e!==this._document&&e.openTag&&e.openTag.selfClosingTag?this._popElement(i(e,e.openTag.endOffset)):r&&r.has(t.name)&&this._popElement(i(e,t.startOffset)),this._pushElement(t)}return}let e=this._stack.peekLast();for(;this._stack.length>1&&e&&e.name!==t.name;)this._popElement(i(e,t.startOffset)),e=this._stack.peekLast();function i(t,e){return new A(t.name,e,e,new Map,!1,!1)}1!==this._stack.length&&this._popElement(t)}_popElement(t){const e=this._stack.pop();e&&(e.closeTag=t)}_pushElement(t){const e=this._stack.peekLast(),i=new P(t.name);e&&(i.parent=e,e.children.push(i)),i.openTag=t,this._stack.push(i)}peekToken(){return this._tokenIndex<this._tokens.length?this._tokens[this._tokenIndex]:null}nextToken(){return this._tokens[this._tokenIndex++]}document(){return this._document}}const L=new Set(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),C=new Map([["head",new Set(["body"])],["li",new Set(["li"])],["dt",new Set(["dt","dd"])],["dd",new Set(["dt","dd"])],["p",new Set(["address","article","aside","blockquote","div","dl","fieldset","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","main","nav","ol","p","pre","section","table","ul"])],["rb",new Set(["rb","rt","rtc","rp"])],["rt",new Set(["rb","rt","rtc","rp"])],["rtc",new Set(["rb","rtc","rp"])],["rp",new Set(["rb","rt","rtc","rp"])],["optgroup",new Set(["optgroup"])],["option",new Set(["option","optgroup"])],["colgroup",new Set(["colgroup"])],["thead",new Set(["tbody","tfoot"])],["tbody",new Set(["tbody","tfoot"])],["tfoot",new Set(["tbody"])],["tr",new Set(["tr"])],["td",new Set(["td","th"])],["th",new Set(["td","th"])]]),T={Initial:"Initial",Tag:"Tag",AttributeName:"AttributeName",AttributeValue:"AttributeValue"},I=class{constructor(t,e,i,r){this.value=t,this.type=e,this.startOffset=i,this.endOffset=r}},A=class{constructor(t,e,i,r,n,s){this.name=t,this.startOffset=e,this.endOffset=i,this.attributes=r,this.isOpenTag=n,this.selfClosingTag=s}},P=class{constructor(t){this.name=t,this.children=[],this.parent=null,this.openTag=null,this.closeTag=null}};class O{constructor(t){this.builder=t}format(t,e,i,r){const n=t.substring(i,r);this.builder.addToken(n,i)}}function z(t){const e=CodeMirror.getMode({indentUnit:2},t),i=CodeMirror.startState(e);if(!e)throw new Error("Could not find CodeMirror mode for MimeType: "+t);if(!e.token)throw new Error("Could not find CodeMirror mode with token method: "+t);return(t,r)=>{const n=new CodeMirror.StringStream(t);for(;!n.eol();){const t=e.token(n,i),s=n.current();if(r(s,t,n.start,n.start+s.length)===M)return;n.start=n.pos}}}const M={};function F(t,e,i){let r=null,s="";for(let i=0;i<t.length;i++)try{s="{"===t[i]?`(${t.substring(i)})${e}`:`${t.substring(i)}${e}`,r=n(s,{ecmaVersion:b});break}catch(t){}if(!r)return null;const a=r.end;let o=null;if(new w(t=>{if(o||t.end<a)return w.SkipSubtree;i.has(t.type)&&(o=t)}).walk(r),!o)return null;let l=s.substring(o.start,s.length-e.length);return l.startsWith("{")&&(l=`(${l})`),{baseNode:o,baseExpression:l}}e.Runtime.queryParam("test")&&(console.error=()=>{});const V="Initial",j="Selector",B="Style",D="PropertyName",q="PropertyValue",R="AtRule";function W(){}var K=function(t,e){if(void 0===e&&(e={}),this.toks=this.constructor.BaseParser.tokenizer(t,e),this.options=this.toks.options,this.input=this.toks.input,this.tok=this.last={type:a.eof,start:0,end:0},this.tok.validateRegExpFlags=W,this.tok.validateRegExpPattern=W,this.options.locations){var i=this.toks.curPosition();this.tok.loc=new o(this.toks,i,i)}this.ahead=[],this.context=[],this.curIndent=0,this.curLineStart=0,this.nextLineStart=this.lineEnd(this.curLineStart)+1,this.inAsync=!1,this.inFunction=!1};K.prototype.startNode=function(){return new l(this.toks,this.tok.start,this.options.locations?this.tok.loc.start:null)},K.prototype.storeCurrentPos=function(){return this.options.locations?[this.tok.start,this.tok.loc.start]:this.tok.start},K.prototype.startNodeAt=function(t){return this.options.locations?new l(this.toks,t[0],t[1]):new l(this.toks,t)},K.prototype.finishNode=function(t,e){return t.type=e,t.end=this.last.end,this.options.locations&&(t.loc.end=this.last.loc.end),this.options.ranges&&(t.range[1]=this.last.end),t},K.prototype.dummyNode=function(t){var e=this.startNode();return e.type=t,e.end=e.start,this.options.locations&&(e.loc.end=e.loc.start),this.options.ranges&&(e.range[1]=e.start),this.last={type:a.name,start:e.start,end:e.start,loc:e.loc},e},K.prototype.dummyIdent=function(){var t=this.dummyNode("Identifier");return t.name="",t},K.prototype.dummyString=function(){var t=this.dummyNode("Literal");return t.value=t.raw="",t},K.prototype.eat=function(t){return this.tok.type===t&&(this.next(),!0)},K.prototype.isContextual=function(t){return this.tok.type===a.name&&this.tok.value===t},K.prototype.eatContextual=function(t){return this.tok.value===t&&this.eat(a.name)},K.prototype.canInsertSemicolon=function(){return this.tok.type===a.eof||this.tok.type===a.braceR||p.test(this.input.slice(this.last.end,this.tok.start))},K.prototype.semicolon=function(){return this.eat(a.semi)},K.prototype.expect=function(t){if(this.eat(t))return!0;for(var e=1;e<=2;e++)if(this.lookAhead(e).type===t){for(var i=0;i<e;i++)this.next();return!0}},K.prototype.pushCx=function(){this.context.push(this.curIndent)},K.prototype.popCx=function(){this.curIndent=this.context.pop()},K.prototype.lineEnd=function(t){for(;t<this.input.length&&!h(this.input.charCodeAt(t));)++t;return t},K.prototype.indentationAfter=function(t){for(var e=0;;++t){var i=this.input.charCodeAt(t);if(32===i)++e;else{if(9!==i)return e;e+=this.options.tabSize}}},K.prototype.closes=function(t,e,i,r){return this.tok.type===t||this.tok.type===a.eof||i!==this.curLineStart&&this.curIndent<e&&this.tokenStartsLine()&&(!r||this.nextLineStart>=this.input.length||this.indentationAfter(this.nextLineStart)<e)},K.prototype.tokenStartsLine=function(){for(var t=this.tok.start-1;t>=this.curLineStart;--t){var e=this.input.charCodeAt(t);if(9!==e&&32!==e)return!1}return!0},K.prototype.extend=function(t,e){this[t]=e(this[t])},K.prototype.parse=function(){return this.next(),this.parseTopLevel()},K.extend=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var i=this,r=0;r<t.length;r++)i=t[r](i);return i},K.parse=function(t,e){return new this(t,e).parse()},K.BaseParser=c;var U=K.prototype;function $(t){return t<14&&t>8||32===t||160===t||h(t)}function H(t){return""===t.name}U.next=function(){if(this.last=this.tok,this.ahead.length?this.tok=this.ahead.shift():this.tok=this.readToken(),this.tok.start>=this.nextLineStart){for(;this.tok.start>=this.nextLineStart;)this.curLineStart=this.nextLineStart,this.nextLineStart=this.lineEnd(this.curLineStart)+1;this.curIndent=this.indentationAfter(this.curLineStart)}},U.readToken=function(){for(;;)try{return this.toks.next(),this.toks.type===a.dot&&"."===this.input.substr(this.toks.end,1)&&this.options.ecmaVersion>=6&&(this.toks.end++,this.toks.type=a.ellipsis),new u(this.toks)}catch(s){if(!(s instanceof SyntaxError))throw s;var t=s.message,e=s.raisedAt,i=!0;if(/unterminated/i.test(t))if(e=this.lineEnd(s.pos+1),/string/.test(t))i={start:s.pos,end:e,type:a.string,value:this.input.slice(s.pos+1,e)};else if(/regular expr/i.test(t)){var r=this.input.slice(s.pos,e);try{r=new RegExp(r)}catch(t){}i={start:s.pos,end:e,type:a.regexp,value:r}}else i=!!/template/.test(t)&&{start:s.pos,end:e,type:a.template,value:this.input.slice(s.pos,e)};else if(/invalid (unicode|regexp|number)|expecting unicode|octal literal|is reserved|directly after number|expected number in radix/i.test(t))for(;e<this.input.length&&!$(this.input.charCodeAt(e));)++e;else if(/character escape|expected hexadecimal/i.test(t))for(;e<this.input.length;){var n=this.input.charCodeAt(e++);if(34===n||39===n||h(n))break}else if(/unexpected character/i.test(t))e++,i=!1;else{if(!/regular expression/i.test(t))throw s;i=!0}if(this.resetTo(e),!0===i&&(i={start:e,end:e,type:a.name,value:""}),i)return this.options.locations&&(i.loc=new o(this.toks,d(this.input,i.start),d(this.input,i.end))),i}},U.resetTo=function(t){this.toks.pos=t;var e,i=this.input.charAt(t-1);if(this.toks.exprAllowed=!i||/[[{(,;:?/*=+\-~!|&%^<>]/.test(i)||/[enwfd]/.test(i)&&/\b(case|else|return|throw|new|in|(instance|type)?of|delete|void)$/.test(this.input.slice(t-10,t)),this.options.locations)for(this.toks.curLine=1,this.toks.lineStart=m.lastIndex=0;(e=m.exec(this.input))&&e.index<t;)++this.toks.curLine,this.toks.lineStart=e.index+e[0].length},U.lookAhead=function(t){for(;t>this.ahead.length;)this.ahead.push(this.readToken());return this.ahead[t-1]};var Y=K.prototype;Y.parseTopLevel=function(){var t=this.startNodeAt(this.options.locations?[0,d(this.input,0)]:0);for(t.body=[];this.tok.type!==a.eof;)t.body.push(this.parseStatement());return this.toks.adaptDirectivePrologue(t.body),this.last=this.tok,t.sourceType=this.options.sourceType,this.finishNode(t,"Program")},Y.parseStatement=function(){var t,e=this.tok.type,i=this.startNode();switch(this.toks.isLet()&&(e=a._var,t="let"),e){case a._break:case a._continue:this.next();var r=e===a._break;return this.semicolon()||this.canInsertSemicolon()?i.label=null:(i.label=this.tok.type===a.name?this.parseIdent():null,this.semicolon()),this.finishNode(i,r?"BreakStatement":"ContinueStatement");case a._debugger:return this.next(),this.semicolon(),this.finishNode(i,"DebuggerStatement");case a._do:return this.next(),i.body=this.parseStatement(),i.test=this.eat(a._while)?this.parseParenExpression():this.dummyIdent(),this.semicolon(),this.finishNode(i,"DoWhileStatement");case a._for:this.next();var n=this.options.ecmaVersion>=9&&this.inAsync&&this.eatContextual("await");if(this.pushCx(),this.expect(a.parenL),this.tok.type===a.semi)return this.parseFor(i,null);var s=this.toks.isLet();if(s||this.tok.type===a._var||this.tok.type===a._const){var o=this.parseVar(this.startNode(),!0,s?"let":this.tok.value);return 1!==o.declarations.length||this.tok.type!==a._in&&!this.isContextual("of")?this.parseFor(i,o):(this.options.ecmaVersion>=9&&this.tok.type!==a._in&&(i.await=n),this.parseForIn(i,o))}var l=this.parseExpression(!0);return this.tok.type===a._in||this.isContextual("of")?(this.options.ecmaVersion>=9&&this.tok.type!==a._in&&(i.await=n),this.parseForIn(i,this.toAssignable(l))):this.parseFor(i,l);case a._function:return this.next(),this.parseFunction(i,!0);case a._if:return this.next(),i.test=this.parseParenExpression(),i.consequent=this.parseStatement(),i.alternate=this.eat(a._else)?this.parseStatement():null,this.finishNode(i,"IfStatement");case a._return:return this.next(),this.eat(a.semi)||this.canInsertSemicolon()?i.argument=null:(i.argument=this.parseExpression(),this.semicolon()),this.finishNode(i,"ReturnStatement");case a._switch:var p,h=this.curIndent,c=this.curLineStart;for(this.next(),i.discriminant=this.parseParenExpression(),i.cases=[],this.pushCx(),this.expect(a.braceL);!this.closes(a.braceR,h,c,!0);)if(this.tok.type===a._case||this.tok.type===a._default){var u=this.tok.type===a._case;p&&this.finishNode(p,"SwitchCase"),i.cases.push(p=this.startNode()),p.consequent=[],this.next(),p.test=u?this.parseExpression():null,this.expect(a.colon)}else p||(i.cases.push(p=this.startNode()),p.consequent=[],p.test=null),p.consequent.push(this.parseStatement());return p&&this.finishNode(p,"SwitchCase"),this.popCx(),this.eat(a.braceR),this.finishNode(i,"SwitchStatement");case a._throw:return this.next(),i.argument=this.parseExpression(),this.semicolon(),this.finishNode(i,"ThrowStatement");case a._try:if(this.next(),i.block=this.parseBlock(),i.handler=null,this.tok.type===a._catch){var d=this.startNode();this.next(),this.eat(a.parenL)?(d.param=this.toAssignable(this.parseExprAtom(),!0),this.expect(a.parenR)):d.param=null,d.body=this.parseBlock(),i.handler=this.finishNode(d,"CatchClause")}return i.finalizer=this.eat(a._finally)?this.parseBlock():null,i.handler||i.finalizer?this.finishNode(i,"TryStatement"):i.block;case a._var:case a._const:return this.parseVar(i,!1,t||this.tok.value);case a._while:return this.next(),i.test=this.parseParenExpression(),i.body=this.parseStatement(),this.finishNode(i,"WhileStatement");case a._with:return this.next(),i.object=this.parseParenExpression(),i.body=this.parseStatement(),this.finishNode(i,"WithStatement");case a.braceL:return this.parseBlock();case a.semi:return this.next(),this.finishNode(i,"EmptyStatement");case a._class:return this.parseClass(!0);case a._import:return this.options.ecmaVersion>10&&this.lookAhead(1).type===a.parenL?(i.expression=this.parseExpression(),this.semicolon(),this.finishNode(i,"ExpressionStatement")):this.parseImport();case a._export:return this.parseExport();default:if(this.toks.isAsyncFunction())return this.next(),this.next(),this.parseFunction(i,!0,!0);var m=this.parseExpression();return H(m)?(this.next(),this.tok.type===a.eof?this.finishNode(i,"EmptyStatement"):this.parseStatement()):e===a.name&&"Identifier"===m.type&&this.eat(a.colon)?(i.body=this.parseStatement(),i.label=m,this.finishNode(i,"LabeledStatement")):(i.expression=m,this.semicolon(),this.finishNode(i,"ExpressionStatement"))}},Y.parseBlock=function(){var t=this.startNode();this.pushCx(),this.expect(a.braceL);var e=this.curIndent,i=this.curLineStart;for(t.body=[];!this.closes(a.braceR,e,i,!0);)t.body.push(this.parseStatement());return this.popCx(),this.eat(a.braceR),this.finishNode(t,"BlockStatement")},Y.parseFor=function(t,e){return t.init=e,t.test=t.update=null,this.eat(a.semi)&&this.tok.type!==a.semi&&(t.test=this.parseExpression()),this.eat(a.semi)&&this.tok.type!==a.parenR&&(t.update=this.parseExpression()),this.popCx(),this.expect(a.parenR),t.body=this.parseStatement(),this.finishNode(t,"ForStatement")},Y.parseForIn=function(t,e){var i=this.tok.type===a._in?"ForInStatement":"ForOfStatement";return this.next(),t.left=e,t.right=this.parseExpression(),this.popCx(),this.expect(a.parenR),t.body=this.parseStatement(),this.finishNode(t,i)},Y.parseVar=function(t,e,i){t.kind=i,this.next(),t.declarations=[];do{var r=this.startNode();r.id=this.options.ecmaVersion>=6?this.toAssignable(this.parseExprAtom(),!0):this.parseIdent(),r.init=this.eat(a.eq)?this.parseMaybeAssign(e):null,t.declarations.push(this.finishNode(r,"VariableDeclarator"))}while(this.eat(a.comma));if(!t.declarations.length){var n=this.startNode();n.id=this.dummyIdent(),t.declarations.push(this.finishNode(n,"VariableDeclarator"))}return e||this.semicolon(),this.finishNode(t,"VariableDeclaration")},Y.parseClass=function(t){var e=this.startNode();this.next(),this.tok.type===a.name?e.id=this.parseIdent():e.id=!0===t?this.dummyIdent():null,e.superClass=this.eat(a._extends)?this.parseExpression():null,e.body=this.startNode(),e.body.body=[],this.pushCx();var i=this.curIndent+1,r=this.curLineStart;for(this.eat(a.braceL),this.curIndent+1<i&&(i=this.curIndent,r=this.curLineStart);!this.closes(a.braceR,i,r);)if(!this.semicolon()){var n=this.startNode(),s=void 0,o=void 0;this.options.ecmaVersion>=6&&(n.static=!1,s=this.eat(a.star)),this.parsePropertyName(n),H(n.key)?(H(this.parseMaybeAssign())&&this.next(),this.eat(a.comma)):("Identifier"!==n.key.type||n.computed||"static"!==n.key.name||this.tok.type===a.parenL||this.tok.type===a.braceL?n.static=!1:(n.static=!0,s=this.eat(a.star),this.parsePropertyName(n)),n.computed||"Identifier"!==n.key.type||"async"!==n.key.name||this.tok.type===a.parenL||this.canInsertSemicolon()?o=!1:(o=!0,s=this.options.ecmaVersion>=9&&this.eat(a.star),this.parsePropertyName(n)),this.options.ecmaVersion>=5&&"Identifier"===n.key.type&&!n.computed&&("get"===n.key.name||"set"===n.key.name)&&this.tok.type!==a.parenL&&this.tok.type!==a.braceL?(n.kind=n.key.name,this.parsePropertyName(n),n.value=this.parseMethod(!1)):(n.computed||n.static||s||o||!("Identifier"===n.key.type&&"constructor"===n.key.name||"Literal"===n.key.type&&"constructor"===n.key.value)?n.kind="method":n.kind="constructor",n.value=this.parseMethod(s,o)),e.body.body.push(this.finishNode(n,"MethodDefinition")))}return this.popCx(),this.eat(a.braceR)||(this.last.end=this.tok.start,this.options.locations&&(this.last.loc.end=this.tok.loc.start)),this.semicolon(),this.finishNode(e.body,"ClassBody"),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")},Y.parseFunction=function(t,e,i){var r=this.inAsync,n=this.inFunction;return this.initFunction(t),this.options.ecmaVersion>=6&&(t.generator=this.eat(a.star)),this.options.ecmaVersion>=8&&(t.async=!!i),this.tok.type===a.name?t.id=this.parseIdent():!0===e&&(t.id=this.dummyIdent()),this.inAsync=t.async,this.inFunction=!0,t.params=this.parseFunctionParams(),t.body=this.parseBlock(),this.toks.adaptDirectivePrologue(t.body.body),this.inAsync=r,this.inFunction=n,this.finishNode(t,e?"FunctionDeclaration":"FunctionExpression")},Y.parseExport=function(){var t=this.startNode();if(this.next(),this.eat(a.star))return t.source=this.eatContextual("from")?this.parseExprAtom():this.dummyString(),this.finishNode(t,"ExportAllDeclaration");if(this.eat(a._default)){var e;if(this.tok.type===a._function||(e=this.toks.isAsyncFunction())){var i=this.startNode();this.next(),e&&this.next(),t.declaration=this.parseFunction(i,"nullableID",e)}else this.tok.type===a._class?t.declaration=this.parseClass("nullableID"):(t.declaration=this.parseMaybeAssign(),this.semicolon());return this.finishNode(t,"ExportDefaultDeclaration")}return this.tok.type.keyword||this.toks.isLet()||this.toks.isAsyncFunction()?(t.declaration=this.parseStatement(),t.specifiers=[],t.source=null):(t.declaration=null,t.specifiers=this.parseExportSpecifierList(),t.source=this.eatContextual("from")?this.parseExprAtom():null,this.semicolon()),this.finishNode(t,"ExportNamedDeclaration")},Y.parseImport=function(){var t,e=this.startNode();(this.next(),this.tok.type===a.string)?(e.specifiers=[],e.source=this.parseExprAtom()):(this.tok.type===a.name&&"from"!==this.tok.value&&((t=this.startNode()).local=this.parseIdent(),this.finishNode(t,"ImportDefaultSpecifier"),this.eat(a.comma)),e.specifiers=this.parseImportSpecifiers(),e.source=this.eatContextual("from")&&this.tok.type===a.string?this.parseExprAtom():this.dummyString(),t&&e.specifiers.unshift(t));return this.semicolon(),this.finishNode(e,"ImportDeclaration")},Y.parseImportSpecifiers=function(){var t=[];if(this.tok.type===a.star){var e=this.startNode();this.next(),e.local=this.eatContextual("as")?this.parseIdent():this.dummyIdent(),t.push(this.finishNode(e,"ImportNamespaceSpecifier"))}else{var i=this.curIndent,r=this.curLineStart,n=this.nextLineStart;for(this.pushCx(),this.eat(a.braceL),this.curLineStart>n&&(n=this.curLineStart);!this.closes(a.braceR,i+(this.curLineStart<=n?1:0),r);){var s=this.startNode();if(this.eat(a.star))s.local=this.eatContextual("as")?this.parseIdent():this.dummyIdent(),this.finishNode(s,"ImportNamespaceSpecifier");else{if(this.isContextual("from"))break;if(s.imported=this.parseIdent(),H(s.imported))break;s.local=this.eatContextual("as")?this.parseIdent():s.imported,this.finishNode(s,"ImportSpecifier")}t.push(s),this.eat(a.comma)}this.eat(a.braceR),this.popCx()}return t},Y.parseExportSpecifierList=function(){var t=[],e=this.curIndent,i=this.curLineStart,r=this.nextLineStart;for(this.pushCx(),this.eat(a.braceL),this.curLineStart>r&&(r=this.curLineStart);!this.closes(a.braceR,e+(this.curLineStart<=r?1:0),i)&&!this.isContextual("from");){var n=this.startNode();if(n.local=this.parseIdent(),H(n.local))break;n.exported=this.eatContextual("as")?this.parseIdent():n.local,this.finishNode(n,"ExportSpecifier"),t.push(n),this.eat(a.comma)}return this.eat(a.braceR),this.popCx(),t};var G=K.prototype;function J(e){let i,r=[],a=0;try{i=n(e,{ecmaVersion:b,ranges:!1})}catch(t){i=K.parse(e,{ecmaVersion:b,ranges:!1})}const o=t.findLineEndingIndexes(e),l=new s.TextCursor(o);return new w((function(t){if("ClassDeclaration"===t.type)p(t.id);else if("VariableDeclarator"===t.type&&t.init&&d(t.init))p(t.id);else if("AssignmentExpression"===t.type&&c(t.left)&&d(t.right))p(t.left);else if("Property"===t.type&&c(t.key)&&d(t.value))p(t.key);else if("FunctionDeclaration"===t.type)h(t.id,t);else if("VariableDeclarator"===t.type&&t.init&&u(t.init))h(t.id,t.init);else if("AssignmentExpression"===t.type&&c(t.left)&&u(t.right))h(t.left,t.right);else if(("MethodDefinition"===t.type||"Property"===t.type)&&c(t.key)&&u(t.value)){const e=[];"get"!==t.kind&&"set"!==t.kind||e.push(t.kind),"static"in t&&t.static&&e.push("static"),h(t.key,t.value,e.join(" "))}return})).walk(i),{chunk:r,isLastChunk:!0};function p(t){const e="class "+m(t);l.advance(t.start),g({name:e,line:l.lineNumber(),column:l.columnNumber(),arguments:void 0})}function h(t,e,i){let r=m(t);const n=e;n.generator&&(r="*"+r),i&&(r=i+" "+r),n.async&&(r="async "+r),l.advance(t.start),g({name:r,line:l.lineNumber(),column:l.columnNumber(),arguments:f(n.params)})}function c(t){return!!t&&("MemberExpression"===t.type?!t.computed&&"Identifier"===t.property.type:"Identifier"===t.type)}function u(t){return!!t&&("FunctionExpression"===t.type||"ArrowFunctionExpression"===t.type)}function d(t){return!!t&&"ClassExpression"===t.type}function m(t){"MemberExpression"===t.type&&(t=t.property),console.assert("Identifier"===t.type,"Cannot extract identifier from unknown type: "+t.type);return t.name}function f(t){const e=[];for(const i of t)"Identifier"===i.type?e.push(i.name):"RestElement"===i.type&&"Identifier"===i.argument.type?e.push("..."+i.argument.name):console.error("Error: unexpected function parameter type: "+i.type);return"("+e.join(", ")+")"}function g(t){r.push(t),l.offset()-a<1e5||(postMessage({chunk:r,isLastChunk:!1}),r=[],a=l.offset())}}G.checkLVal=function(t){if(!t)return t;switch(t.type){case"Identifier":case"MemberExpression":return t;case"ParenthesizedExpression":return t.expression=this.checkLVal(t.expression),t;default:return this.dummyIdent()}},G.parseExpression=function(t){var e=this.storeCurrentPos(),i=this.parseMaybeAssign(t);if(this.tok.type===a.comma){var r=this.startNodeAt(e);for(r.expressions=[i];this.eat(a.comma);)r.expressions.push(this.parseMaybeAssign(t));return this.finishNode(r,"SequenceExpression")}return i},G.parseParenExpression=function(){this.pushCx(),this.expect(a.parenL);var t=this.parseExpression();return this.popCx(),this.expect(a.parenR),t},G.parseMaybeAssign=function(t){if(this.toks.isContextual("yield")){var e=this.startNode();return this.next(),this.semicolon()||this.canInsertSemicolon()||this.tok.type!==a.star&&!this.tok.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(a.star),e.argument=this.parseMaybeAssign()),this.finishNode(e,"YieldExpression")}var i=this.storeCurrentPos(),r=this.parseMaybeConditional(t);if(this.tok.type.isAssign){var n=this.startNodeAt(i);return n.operator=this.tok.value,n.left=this.tok.type===a.eq?this.toAssignable(r):this.checkLVal(r),this.next(),n.right=this.parseMaybeAssign(t),this.finishNode(n,"AssignmentExpression")}return r},G.parseMaybeConditional=function(t){var e=this.storeCurrentPos(),i=this.parseExprOps(t);if(this.eat(a.question)){var r=this.startNodeAt(e);return r.test=i,r.consequent=this.parseMaybeAssign(),r.alternate=this.expect(a.colon)?this.parseMaybeAssign(t):this.dummyIdent(),this.finishNode(r,"ConditionalExpression")}return i},G.parseExprOps=function(t){var e=this.storeCurrentPos(),i=this.curIndent,r=this.curLineStart;return this.parseExprOp(this.parseMaybeUnary(!1),e,-1,t,i,r)},G.parseExprOp=function(t,e,i,r,n,s){if(this.curLineStart!==s&&this.curIndent<n&&this.tokenStartsLine())return t;var o=this.tok.type.binop;if(null!=o&&(!r||this.tok.type!==a._in)&&o>i){var l=this.startNodeAt(e);if(l.left=t,l.operator=this.tok.value,this.next(),this.curLineStart!==s&&this.curIndent<n&&this.tokenStartsLine())l.right=this.dummyIdent();else{var p=this.storeCurrentPos();l.right=this.parseExprOp(this.parseMaybeUnary(!1),p,o,r,n,s)}return this.finishNode(l,/&&|\|\|/.test(l.operator)?"LogicalExpression":"BinaryExpression"),this.parseExprOp(l,e,i,r,n,s)}return t},G.parseMaybeUnary=function(t){var e,i=this.storeCurrentPos();if(this.options.ecmaVersion>=8&&this.toks.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))e=this.parseAwait(),t=!0;else if(this.tok.type.prefix){var r=this.startNode(),n=this.tok.type===a.incDec;n||(t=!0),r.operator=this.tok.value,r.prefix=!0,this.next(),r.argument=this.parseMaybeUnary(!0),n&&(r.argument=this.checkLVal(r.argument)),e=this.finishNode(r,n?"UpdateExpression":"UnaryExpression")}else if(this.tok.type===a.ellipsis){var s=this.startNode();this.next(),s.argument=this.parseMaybeUnary(t),e=this.finishNode(s,"SpreadElement")}else for(e=this.parseExprSubscripts();this.tok.type.postfix&&!this.canInsertSemicolon();){var o=this.startNodeAt(i);o.operator=this.tok.value,o.prefix=!1,o.argument=this.checkLVal(e),this.next(),e=this.finishNode(o,"UpdateExpression")}if(!t&&this.eat(a.starstar)){var l=this.startNodeAt(i);return l.operator="**",l.left=e,l.right=this.parseMaybeUnary(!1),this.finishNode(l,"BinaryExpression")}return e},G.parseExprSubscripts=function(){var t=this.storeCurrentPos();return this.parseSubscripts(this.parseExprAtom(),t,!1,this.curIndent,this.curLineStart)},G.parseSubscripts=function(t,e,i,r,n){for(;;){if(this.curLineStart!==n&&this.curIndent<=r&&this.tokenStartsLine()){if(this.tok.type!==a.dot||this.curIndent!==r)return t;--r}var s="Identifier"===t.type&&"async"===t.name&&!this.canInsertSemicolon();if(this.eat(a.dot)){var o=this.startNodeAt(e);o.object=t,this.curLineStart!==n&&this.curIndent<=r&&this.tokenStartsLine()?o.property=this.dummyIdent():o.property=this.parsePropertyAccessor()||this.dummyIdent(),o.computed=!1,t=this.finishNode(o,"MemberExpression")}else if(this.tok.type===a.bracketL){this.pushCx(),this.next();var l=this.startNodeAt(e);l.object=t,l.property=this.parseExpression(),l.computed=!0,this.popCx(),this.expect(a.bracketR),t=this.finishNode(l,"MemberExpression")}else if(i||this.tok.type!==a.parenL){if(this.tok.type!==a.backQuote)return t;var p=this.startNodeAt(e);p.tag=t,p.quasi=this.parseTemplate(),t=this.finishNode(p,"TaggedTemplateExpression")}else{var h=this.parseExprList(a.parenR);if(s&&this.eat(a.arrow))return this.parseArrowExpression(this.startNodeAt(e),h,!0);var c=this.startNodeAt(e);c.callee=t,c.arguments=h,t=this.finishNode(c,"CallExpression")}}},G.parseExprAtom=function(){var t;switch(this.tok.type){case a._this:case a._super:var e=this.tok.type===a._this?"ThisExpression":"Super";return t=this.startNode(),this.next(),this.finishNode(t,e);case a.name:var i=this.storeCurrentPos(),r=this.parseIdent(),n=!1;if("async"===r.name&&!this.canInsertSemicolon()){if(this.eat(a._function))return this.parseFunction(this.startNodeAt(i),!1,!0);this.tok.type===a.name&&(r=this.parseIdent(),n=!0)}return this.eat(a.arrow)?this.parseArrowExpression(this.startNodeAt(i),[r],n):r;case a.regexp:t=this.startNode();var s=this.tok.value;return t.regex={pattern:s.pattern,flags:s.flags},t.value=s.value,t.raw=this.input.slice(this.tok.start,this.tok.end),this.next(),this.finishNode(t,"Literal");case a.num:case a.string:return(t=this.startNode()).value=this.tok.value,t.raw=this.input.slice(this.tok.start,this.tok.end),this.tok.type===a.num&&110===t.raw.charCodeAt(t.raw.length-1)&&(t.bigint=t.raw.slice(0,-1)),this.next(),this.finishNode(t,"Literal");case a._null:case a._true:case a._false:return(t=this.startNode()).value=this.tok.type===a._null?null:this.tok.type===a._true,t.raw=this.tok.type.keyword,this.next(),this.finishNode(t,"Literal");case a.parenL:var o=this.storeCurrentPos();this.next();var l=this.parseExpression();if(this.expect(a.parenR),this.eat(a.arrow)){var p=l.expressions||[l];return p.length&&H(p[p.length-1])&&p.pop(),this.parseArrowExpression(this.startNodeAt(o),p)}if(this.options.preserveParens){var h=this.startNodeAt(o);h.expression=l,l=this.finishNode(h,"ParenthesizedExpression")}return l;case a.bracketL:return(t=this.startNode()).elements=this.parseExprList(a.bracketR,!0),this.finishNode(t,"ArrayExpression");case a.braceL:return this.parseObj();case a._class:return this.parseClass(!1);case a._function:return t=this.startNode(),this.next(),this.parseFunction(t,!1);case a._new:return this.parseNew();case a.backQuote:return this.parseTemplate();case a._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.dummyIdent();default:return this.dummyIdent()}},G.parseExprImport=function(){var t=this.startNode();switch(this.next(),this.tok.type){case a.parenL:return this.parseDynamicImport(t);default:return t.name="import",this.finishNode(t,"Identifier")}},G.parseDynamicImport=function(t){return t.source=this.parseExprList(a.parenR)[0]||this.dummyString(),this.finishNode(t,"ImportExpression")},G.parseNew=function(){var t=this.startNode(),e=this.curIndent,i=this.curLineStart,r=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(a.dot))return t.meta=r,t.property=this.parseIdent(!0),this.finishNode(t,"MetaProperty");var n=this.storeCurrentPos();return t.callee=this.parseSubscripts(this.parseExprAtom(),n,!0,e,i),this.tok.type===a.parenL?t.arguments=this.parseExprList(a.parenR):t.arguments=[],this.finishNode(t,"NewExpression")},G.parseTemplateElement=function(){var t=this.startNode();return this.tok.type===a.invalidTemplate?t.value={raw:this.tok.value,cooked:null}:t.value={raw:this.input.slice(this.tok.start,this.tok.end).replace(/\r\n?/g,"\n"),cooked:this.tok.value},this.next(),t.tail=this.tok.type===a.backQuote,this.finishNode(t,"TemplateElement")},G.parseTemplate=function(){var t=this.startNode();this.next(),t.expressions=[];var e=this.parseTemplateElement();for(t.quasis=[e];!e.tail;)this.next(),t.expressions.push(this.parseExpression()),this.expect(a.braceR)?e=this.parseTemplateElement():((e=this.startNode()).value={cooked:"",raw:""},e.tail=!0,this.finishNode(e,"TemplateElement")),t.quasis.push(e);return this.expect(a.backQuote),this.finishNode(t,"TemplateLiteral")},G.parseObj=function(){var t=this.startNode();t.properties=[],this.pushCx();var e=this.curIndent+1,i=this.curLineStart;for(this.eat(a.braceL),this.curIndent+1<e&&(e=this.curIndent,i=this.curLineStart);!this.closes(a.braceR,e,i);){var r=this.startNode(),n=void 0,s=void 0,o=void 0;if(this.options.ecmaVersion>=9&&this.eat(a.ellipsis))r.argument=this.parseMaybeAssign(),t.properties.push(this.finishNode(r,"SpreadElement")),this.eat(a.comma);else if(this.options.ecmaVersion>=6&&(o=this.storeCurrentPos(),r.method=!1,r.shorthand=!1,n=this.eat(a.star)),this.parsePropertyName(r),this.toks.isAsyncProp(r)?(s=!0,n=this.options.ecmaVersion>=9&&this.eat(a.star),this.parsePropertyName(r)):s=!1,H(r.key))H(this.parseMaybeAssign())&&this.next(),this.eat(a.comma);else{if(this.eat(a.colon))r.kind="init",r.value=this.parseMaybeAssign();else if(this.options.ecmaVersion>=6&&(this.tok.type===a.parenL||this.tok.type===a.braceL))r.kind="init",r.method=!0,r.value=this.parseMethod(n,s);else if(this.options.ecmaVersion>=5&&"Identifier"===r.key.type&&!r.computed&&("get"===r.key.name||"set"===r.key.name)&&this.tok.type!==a.comma&&this.tok.type!==a.braceR&&this.tok.type!==a.eq)r.kind=r.key.name,this.parsePropertyName(r),r.value=this.parseMethod(!1);else{if(r.kind="init",this.options.ecmaVersion>=6)if(this.eat(a.eq)){var l=this.startNodeAt(o);l.operator="=",l.left=r.key,l.right=this.parseMaybeAssign(),r.value=this.finishNode(l,"AssignmentExpression")}else r.value=r.key;else r.value=this.dummyIdent();r.shorthand=!0}t.properties.push(this.finishNode(r,"Property")),this.eat(a.comma)}}return this.popCx(),this.eat(a.braceR)||(this.last.end=this.tok.start,this.options.locations&&(this.last.loc.end=this.tok.loc.start)),this.finishNode(t,"ObjectExpression")},G.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(a.bracketL))return t.computed=!0,t.key=this.parseExpression(),void this.expect(a.bracketR);t.computed=!1}var e=this.tok.type===a.num||this.tok.type===a.string?this.parseExprAtom():this.parseIdent();t.key=e||this.dummyIdent()},G.parsePropertyAccessor=function(){if(this.tok.type===a.name||this.tok.type.keyword)return this.parseIdent()},G.parseIdent=function(){var t=this.tok.type===a.name?this.tok.value:this.tok.type.keyword;if(!t)return this.dummyIdent();var e=this.startNode();return this.next(),e.name=t,this.finishNode(e,"Identifier")},G.initFunction=function(t){t.id=null,t.params=[],this.options.ecmaVersion>=6&&(t.generator=!1,t.expression=!1),this.options.ecmaVersion>=8&&(t.async=!1)},G.toAssignable=function(t,e){if(!t||"Identifier"===t.type||"MemberExpression"===t.type&&!e);else if("ParenthesizedExpression"===t.type)this.toAssignable(t.expression,e);else{if(this.options.ecmaVersion<6)return this.dummyIdent();if("ObjectExpression"===t.type){t.type="ObjectPattern";for(var i=0,r=t.properties;i<r.length;i+=1){var n=r[i];this.toAssignable(n,e)}}else if("ArrayExpression"===t.type)t.type="ArrayPattern",this.toAssignableList(t.elements,e);else if("Property"===t.type)this.toAssignable(t.value,e);else if("SpreadElement"===t.type)t.type="RestElement",this.toAssignable(t.argument,e);else{if("AssignmentExpression"!==t.type)return this.dummyIdent();t.type="AssignmentPattern",delete t.operator}}return t},G.toAssignableList=function(t,e){for(var i=0,r=t;i<r.length;i+=1){var n=r[i];this.toAssignable(n,e)}return t},G.parseFunctionParams=function(t){return t=this.parseExprList(a.parenR),this.toAssignableList(t,!0)},G.parseMethod=function(t,e){var i=this.startNode(),r=this.inAsync,n=this.inFunction;return this.initFunction(i),this.options.ecmaVersion>=6&&(i.generator=!!t),this.options.ecmaVersion>=8&&(i.async=!!e),this.inAsync=i.async,this.inFunction=!0,i.params=this.parseFunctionParams(),i.body=this.parseBlock(),this.toks.adaptDirectivePrologue(i.body.body),this.inAsync=r,this.inFunction=n,this.finishNode(i,"FunctionExpression")},G.parseArrowExpression=function(t,e,i){var r=this.inAsync,n=this.inFunction;return this.initFunction(t),this.options.ecmaVersion>=8&&(t.async=!!i),this.inAsync=t.async,this.inFunction=!0,t.params=this.toAssignableList(e,!0),t.expression=this.tok.type!==a.braceL,t.expression?t.body=this.parseMaybeAssign():(t.body=this.parseBlock(),this.toks.adaptDirectivePrologue(t.body.body)),this.inAsync=r,this.inFunction=n,this.finishNode(t,"ArrowFunctionExpression")},G.parseExprList=function(t,e){this.pushCx();var i=this.curIndent,r=this.curLineStart,n=[];for(this.next();!this.closes(t,i+1,r);)if(this.eat(a.comma))n.push(e?null:this.dummyIdent());else{var s=this.parseMaybeAssign();if(H(s)){if(this.closes(t,i,r))break;this.next()}else n.push(s);this.eat(a.comma)}return this.popCx(),this.eat(t)||(this.last.end=this.tok.start,this.options.locations&&(this.last.loc.end=this.tok.loc.start)),n},G.parseAwait=function(){var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(),this.finishNode(t,"AwaitExpression")},f.tabSize=4,self.onmessage=function(e){const s=e.data.method,a=e.data.params;if(s)switch(s){case"format":self.postMessage(function(e,i,r){const n={},s=new _(r=r||"    "),a=t.findLineEndingIndexes(i);try{switch(e){case"text/html":new N(s).format(i,a);break;case"text/css":new k(s).format(i,a,0,i.length);break;case"text/javascript":new S(s).format(i,a,0,i.length);break;default:new O(s).format(i,a,0,i.length)}n.mapping=s.mapping,n.content=s.content()}catch(t){console.error(t),n.mapping={original:[0],formatted:[0]},n.content=i}return n}(a.mimeType,a.content,a.indentString));break;case"parseCSS":!function t(e,i){const r=e.split("\n");let n,s,a=[],o=0,l=V;const p=new Set;let h=[];function c(t){h=h.concat(t.chunk)}function u(e,r,u,d){const g=r?new Set(r.split(" ")):p;switch(l){case V:g.has("qualifier")||g.has("builtin")||g.has("tag")?(n={selectorText:e,lineNumber:m,columnNumber:u,properties:[]},l=j):g.has("def")&&(n={atRule:e,lineNumber:m,columnNumber:u},l=R);break;case j:"{"===e&&g===p?(n.selectorText=n.selectorText.trim(),n.styleRange=f(m,d),l=B):n.selectorText+=e;break;case R:";"!==e&&"{"!==e||g!==p?n.atRule+=e:(n.atRule=n.atRule.trim(),a.push(n),l=V);break;case B:if(g.has("meta")||g.has("property"))s={name:e,value:"",range:f(m,u),nameRange:f(m,u)},l=D;else if("}"===e&&g===p)n.styleRange.endLine=m,n.styleRange.endColumn=u,a.push(n),l=V;else if(g.has("comment")){if("/*"!==e.substring(0,2)||"*/"!==e.substring(e.length-2))break;const i=e.substring(2,e.length-2);if(h=[],t("a{\n"+i+"}",c),1===h.length&&1===h[0].properties.length){const t=h[0].properties[0];t.disabled=!0,t.range=f(m,u),t.range.endColumn=d;const e=m-1,i=u+2;t.nameRange.startLine+=e,t.nameRange.startColumn+=i,t.nameRange.endLine+=e,t.nameRange.endColumn+=i,t.valueRange.startLine+=e,t.valueRange.startColumn+=i,t.valueRange.endLine+=e,t.valueRange.endColumn+=i,n.properties.push(t)}}break;case D:":"===e&&g===p?(s.name=s.name,s.nameRange.endLine=m,s.nameRange.endColumn=u,s.valueRange=f(m,d),l=q):g.has("property")&&(s.name+=e);break;case q:";"!==e&&"}"!==e||g!==p?g.has("comment")||(s.value+=e):(s.value=s.value,s.valueRange.endLine=m,s.valueRange.endColumn=u,s.range.endLine=m,s.range.endColumn=";"===e?d:u,n.properties.push(s),"}"===e?(n.styleRange.endLine=m,n.styleRange.endColumn=u,a.push(n),l=V):l=B);break;default:console.assert(!1,"Unknown CSS parser state.")}o+=d-u,o>1e5&&(i({chunk:a,isLastChunk:!1}),a=[],o=0)}const d=z("text/css");let m;for(m=0;m<r.length;++m){const t=r[m];d(t,u),u("\n",null,t.length,t.length+1)}function f(t,e){return{startLine:t,startColumn:e,endLine:t,endColumn:e}}i({chunk:a,isLastChunk:!0})}(a.content,self.postMessage);break;case"javaScriptOutline":self.postMessage(J(a.content));break;case"javaScriptIdentifiers":self.postMessage(function(t){let e=null;try{e=n(t,{ecmaVersion:b,ranges:!1})}catch(t){}const i=[],r=new w((function(t){if(s(t))return t.id&&i.push(t.id),w.SkipSubtree;if("Identifier"!==t.type)return;if(t.parent&&"MemberExpression"===t.parent.type){const e=t.parent;if(e.property===t&&!e.computed)return}return void i.push(t)}));function s(t){return"FunctionDeclaration"===t.type||"FunctionExpression"===t.type||"ArrowFunctionExpression"===t.type}if(!e||"Program"!==e.type||1!==e.body.length||!s(e.body[0]))return[];const a=e.body[0];for(const t of a.params)r.walk(t);return r.walk(a.body),i.map(t=>({name:"name"in t&&t.name||void 0,offset:t.start}))}(a.content));break;case"evaluatableJavaScriptSubstring":self.postMessage(function(t){const e=i(t,{ecmaVersion:b});let n="";try{let i=e.getToken();for(;i.type!==r.eof&&y.punctuator(i);)i=e.getToken();const s=i.start;let a=i.end,o=0;for(;i.type!==r.eof;){const t=y.identifier(i),n=y.keyword(i,"this"),s=i.type===r.string;if(!n&&!t&&!s)break;for(a=i.end,i=e.getToken();y.punctuator(i,".[]");)y.punctuator(i,"[")&&o++,y.punctuator(i,"]")&&(a=o>0?i.end:a,o--),i=e.getToken()}n=t.substring(s,a)}catch(t){console.error(t)}return n}(a.content));break;case"findLastExpression":self.postMessage(function(t){if(t.length>1e4)return null;try{const e=i(t,{ecmaVersion:b});for(;e.getToken().type!==r.eof;);}catch(t){return null}try{n(t+".DEVTOOLS",{ecmaVersion:b})}catch(e){if(e.message.startsWith("Unexpected token")&&e.pos===t.length)return null}const e=F(t,".DEVTOOLS",new Set(["MemberExpression","Identifier"]));return e?e.baseExpression:null}(a.content));break;case"findLastFunctionCall":self.postMessage(function(t){if(t.length>1e4)return null;try{const e=i(t,{ecmaVersion:b});for(;e.getToken().type!==r.eof;);}catch(t){return null}const e=F(t,"000)",new Set(["CallExpression","NewExpression"]));if(!e)return null;if("CallExpression"!==e.baseNode.type&&"NewExpression"!==e.baseNode.type)return null;const n=e.baseNode.callee;let s="";const a="Identifier"===n.type?n:n.property;a&&("Identifier"===a.type?s=a.name:"Literal"===a.type&&(s=a.value));const o=e.baseNode.arguments.length-1,l=`(${e.baseExpression.substring(n.start-e.baseNode.start,n.end-e.baseNode.start)})`;let p="(function(){return this})()";if("MemberExpression"===n.type){const t=n.object;p=e.baseExpression.substring(t.start-e.baseNode.start,t.end-e.baseNode.start)}return{baseExpression:l,receiver:p,argumentIndex:o,functionName:s}}(a.content));break;case"argumentsList":self.postMessage(function(t){if(t.length>1e4)return[];let e=null;try{e=n(`(${t})`,{ecmaVersion:b})}catch(t){}if(!e)try{e=n(`({${t}})`,{ecmaVersion:b})}catch(t){}if(!(e&&"body"in e&&Array.isArray(e.body)&&e.body[0]&&"expression"in e.body[0]))return[];const i=e.body[0].expression;let r=null;switch(i.type){case"ClassExpression":{if(!i.body.body)break;const t=i.body.body.find(t=>"constructor"===t.kind);t&&(r=t.value.params);break}case"ObjectExpression":if(!i.properties[0]||!("value"in i.properties[0])||!("params"in i.properties[0].value))break;r=i.properties[0].value.params;break;case"FunctionExpression":case"ArrowFunctionExpression":r=i.params}return r?r.map((function t(e){switch(e.type){case"Identifier":return e.name;case"AssignmentPattern":return"?"+t(e.left);case"ObjectPattern":return"obj";case"ArrayPattern":return"arr";case"RestElement":return"..."+t(e.argument)}return"?"})):[]}(a.content));break;default:console.error("Unsupport method name: "+s)}},self.postMessage("workerReady");
